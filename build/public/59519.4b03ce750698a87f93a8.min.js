(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[59519,38786,70565,83014,99617,89743,93230,588,62735,10882,80560,73382,10999,28306,43034,79191,3564,92497,8311,59330,76830],{74344:(x,E,a)=>{"use strict";a.r(E),a.d(E,{del:()=>r,get:()=>c,head:()=>m,patch:()=>e,post:()=>g,put:()=>o});var h=a(85233),v=a.n(h),p=a(63281),d=a.n(p);const n=config.relative_path+"/api/v3";async function l(t,s){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:n+t.url,typeof s=="function"){b(t).then(u=>s(null,u),u=>s(u));return}try{return await b(t)}catch(u){if(u.message==="A valid login session was not found. Please log in and try again.")return(0,p.confirm)("[[error:api.reauth-required]]",y=>{y&&ajaxify.go("login")});throw u}}async function b(t){const{url:s}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,h.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const u=await fetch(s,t),{headers:y}=u,A=y.get("content-type"),k=A&&A.startsWith("application/json");let w;if(t.method!=="head"&&(k?w=await u.json():w=await u.text()),!u.ok)throw w?new Error(k?w.status.message:w):new Error(u.statusText);return k&&w&&w.hasOwnProperty("status")&&w.hasOwnProperty("response")?w.response:w}function c(t,s,u){return l({url:t+(s&&Object.keys(s).length?"?"+$.param(s):"")},u)}function m(t,s,u){return l({url:t+(s&&Object.keys(s).length?"?"+$.param(s):""),method:"head"},u)}function g(t,s,u){return l({url:t,method:"post",data:s,headers:{"x-csrf-token":config.csrf_token}},u)}function e(t,s,u){return l({url:t,method:"patch",data:s,headers:{"x-csrf-token":config.csrf_token}},u)}function o(t,s,u){return l({url:t,method:"put",data:s,headers:{"x-csrf-token":config.csrf_token}},u)}function r(t,s,u){return l({url:t,method:"delete",data:s,headers:{"x-csrf-token":config.csrf_token}},u)}},47913:(x,E,a)=>{x.exports=a(66485)},45482:(x,E,a)=>{x.exports=a(35729)},83713:(x,E,a)=>{x.exports=a(51077)},38259:(x,E,a)=>{x.exports=a(65616)},11120:x=>{"use strict";x.exports=function(E,a,h){a.setGlobal("true",!0),a.setGlobal("false",!1);const v=24*60*60*1e3,p={displayMenuItem:n,buildMetaTag:l,buildLinkTag:b,stringify:c,escape:m,stripTags:g,buildCategoryIcon:e,buildCategoryLabel:o,generateCategoryBackground:r,generateChildrenCategories:t,generateTopicClass:s,membershipBtn:u,spawnPrivilegeStates:y,localeToHTML:A,renderTopicImage:k,renderDigestAvatar:w,userAgentIcons:I,buildAvatar:D,increment:F,generateRepliedTo:M,generateWrote:U,isoTimeToLocaleString:O,shouldHideReplyContainer:B,humanReadableNumber:T,formattedNumber:W,register:C,__escape:d};function d(i){return i}function n(i,f){const S=i.navigation[f];return!(!S||S.route.match("/users")&&i.user&&!i.user.privileges["view:users"]||S.route.match("/tags")&&i.user&&!i.user.privileges["view:tags"]||S.route.match("/groups")&&i.user&&!i.user.privileges["view:groups"])}function l(i){const f=i.name?'name="'+i.name+'" ':"",S=i.property?'property="'+i.property+'" ':"",R=i.content?'content="'+i.content.replace(/\n/g," ")+'" ':"";return"<meta "+f+S+R+`/>
	`}function b(i){const f=["link","rel","as","type","href","sizes","title","crossorigin"],[S,R,P,L,z,K,N,Y]=f.map(H=>i[H]?`${H}="${i[H]}" `:"");return"<link "+S+R+P+L+K+N+z+Y+`/>
	`}function c(i){return JSON.stringify(i).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function m(i){return E.escapeHTML(i)}function g(i){return E.stripHTMLTags(i)}function e(i,f,S){return i?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${S}" style="${r(i)} width:${f}; height: ${f}; font-size: ${parseInt(f,10)/2}px;">${i.icon?`<i class="fa fa-fw ${i.icon}"></i>`:""}</span>`:""}function o(i,f="a",S=""){if(!i)return"";const R=f==="a"?`href="${h}/category/${i.slug}"`:"";return`<${f} ${R} class="badge px-1 text-truncate text-decoration-none ${S}" style="color: ${i.color};background-color: ${i.bgColor};border-color: ${i.bgColor}!important; max-width: 70vw;">
			${i.icon&&i.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${i.icon}"></i>`:""}
			${i.name}
		</${f}>`}function r(i){if(!i)return"";const f=[];return i.bgColor&&(f.push("background-color: "+i.bgColor),f.push(`border-color: ${i.bgColor}!important`)),i.color&&f.push("color: "+i.color),i.backgroundImage&&(f.push("background-image: url("+i.backgroundImage+")"),i.imageClass&&f.push("background-size: "+i.imageClass)),f.join("; ")+";"}function t(i){let f="";return!i||!i.children||!i.children.length||(i.children.forEach(function(S){if(S&&!S.isSection){const R=S.link?S.link:h+"/category/"+S.slug;f+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+r(S)+'"><i class="fa fa-fw '+S.icon+'"></i></div><a href="'+R+'"><small>'+S.name+"</small></a></span>"}}),f=f&&'<span class="category-children">'+f+"</span>"),f}function s(i){return["locked","pinned","deleted","unread","scheduled"].filter(S=>!!i[S]).join(" ")}function u(i,f=""){return i.isMember&&i.name!=="administrators"?`<button class="btn btn-danger ${f}" data-action="leave" data-group="${i.displayName}" ${i.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:i.isPending&&i.name!=="administrators"?`<button class="btn btn-warning disabled ${f}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:i.isInvited?`<button class="btn btn-link" data-action="rejectInvite" data-group="${i.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${i.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!i.disableJoinRequests&&i.name!=="administrators"?`<button class="btn btn-success" data-action="join" data-group="${i.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function y(i,f,S){const R=[];for(const P in f)f.hasOwnProperty(P)&&R.push({name:P,state:f[P],type:S[P]});return R.map(function(P){const L=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],z=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],K=["groups:moderate"],N=i==="guests"&&(L.includes(P.name)||P.name.startsWith("groups:admin:"))||i==="spiders"&&!z.includes(P.name)||i==="Global Moderators"&&K.includes(P.name);return`
				<td data-privilege="${P.name}" data-value="${P.state}" data-type="${P.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${P.state?" checked":""}${N?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function A(i,f){return i=i||f||"en-GB",i.replace("_","-")}function k(i){return i.thumb?'<img src="'+i.thumb+'" class="img-circle user-img" title="'+i.user.username+'" />':'<img component="user/picture" data-uid="'+i.user.uid+'" src="'+i.user.picture+'" class="user-img" title="'+i.user.username+'" />'}function w(i){return i.teaser?i.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.teaser.user.picture+'" title="'+i.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.teaser.user["icon:text"]+"</div>":i.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.user.picture+'" title="'+i.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.user["icon:text"]+"</div>"}function I(i){let f="";switch(i.platform){case"Linux":f+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":f+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":f+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":f+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":f+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":f+='<i class="fa fa-fw fa-mobile"></i>';break;default:f+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(i.browser){case"Chrome":f+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":f+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":f+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":f+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":f+='<i class="fa fa-fw fa-edge"></i>';break;default:f+='<i class="fa fa-fw fa-question-circle"></i>';break}return f}function D(i,f,S,R,P){i||(i=this);const L=new Map([["alt",i.username],["title",i.username],["data-uid",i.uid],["loading","lazy"]]),z=[`--avatar-size: ${f};`],K=Y=>Array.from(Y).reduce((H,[J,j])=>(H+=` ${J}="${j}"`,H),"");R=R||"",L.set("class",`avatar ${R}${S?" avatar-rounded":""}`);let N="";return i.picture&&(L.set("component",P||"avatar/picture"),N+="<img "+K(L)+' src="'+i.picture+'" style="'+z.join(" ")+'" onError="this.remove();" itemprop="image" />'),L.set("component",P||"avatar/icon"),z.push("background-color: "+i["icon:bgColor"]+";"),N+="<span "+K(L)+' style="'+z.join(" ")+'">'+i["icon:text"]+"</span>",N}function F(i,f){return String(i+parseInt(f,10))}function M(i,f){const S=i.parent&&i.parent.displayname?i.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${i.timestamp<Date.now()-f*v?"on":"ago"}, ${i.toPid}, ${h}/post/${i.toPid}, ${S}, ${h}/post/${i.pid}, ${i.timestampISO}]]`}function U(i,f){return`[[topic:wrote-${i.timestamp<Date.now()-f*v?"on":"ago"}, ${h}/post/${i.pid}, ${i.timestampISO}]]`}function O(i){return new Date(i).toLocaleString().replace(/,/g,"&#44;")}function B(i){return!!(i.replies.count<=0||i.replies.hasSingleImmediateReply)}function T(i,f=1){return E.makeNumberHumanReadable(i,f)}function W(i){return E.addCommas(i)}function C(){Object.keys(p).forEach(function(i){a.registerHelper(i,p[i])})}return p}},59265:(x,E,a)=>{"use strict";var h,v;const p=a(11120);h=[a(96795),a(59006)],v=function(d,n){return p(d,n,config.relative_path)}.apply(E,h),v!==void 0&&(x.exports=v)},22568:(x,E,a)=>{"use strict";var h,v,p;(function(d){v=[a(20648)],h=d,p=typeof h=="function"?h.apply(E,v):h,p!==void 0&&(x.exports=p)})(function(d){const n=d("[^\\p{L}\\s\\d\\-_]","g"),l=/[^\w\s\d\-_]/g,b=/^\s+|\s+$/g,c=/\s+/g,m=/-+/g,g=/-$/g,e=/^-/g,o=/^[\w\d\s.,\-@]+$/;return function(t,s){return t?(t=String(t).replace(b,""),o.test(t)?t=t.replace(l,"-"):t=d.replace(t,n,"-"),t=s?t:t.toLocaleLowerCase(),t=t.replace(c,"-"),t=t.replace(m,"-"),t=t.replace(g,""),t=t.replace(e,""),t):""}})},66603:(x,E,a)=>{"use strict";var h;h=function(){function v(){this._store={},this._keys=[]}v.prototype.isMock=!0,v.prototype.setItem=function(n,l){n=String(n),this._keys.indexOf(n)===-1&&this._keys.push(n),this._store[n]=l},v.prototype.getItem=function(n){return n=String(n),this._keys.indexOf(n)===-1?null:this._store[n]},v.prototype.removeItem=function(n){n=String(n),this._keys=this._keys.filter(function(l){return l!==n}),this._store[n]=null},v.prototype.clear=function(){this._keys=[],this._store={}},v.prototype.key=function(n){return n=parseInt(n,10)||0,this._keys[n]},Object.defineProperty&&Object.defineProperty(v.prototype,"length",{get:function(){return this._keys.length}});let p;const d=Date.now().toString();try{if(p=window.localStorage,p.setItem(d,d),p.getItem(d)!==d)throw Error("localStorage behaved unexpectedly");return p.removeItem(d),p}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(p=window.sessionStorage,p.setItem(d,d),p.getItem(d)!==d)throw Error("sessionStorage behaved unexpectedly");return p.removeItem(d),p}catch(l){return console.warn(l),console.warn("sessionStorage failed, falling back on memory storage"),new v}}}.call(E,a,E,x),h!==void 0&&(x.exports=h)},27145:(x,E,a)=>{"use strict";x=a.nmd(x);var h,v;h=[a(32230),a(85233)],v=function(p,d){const n={};let l=!1;n.init=function(){if(n.taskbar=$('[component="taskbar"]'),n.tasklist=n.taskbar.find("ul"),!n.taskbar.length||!n.tasklist.length){l=!0;return}n.taskbar.on("click","li",async function(){const e=$(this),o=e.attr("data-module"),r=e.attr("data-uuid"),t=await app.require(o);return e.hasClass("active")?t.minimize(r):(c(),t.load(r),n.toggleNew(r,!1),n.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){n.closeAll()})},n.close=async function(e,o){if(l)return;if(n.tasklist.find('[data-module="'+x+'"][data-uuid="'+o+'"]').length){const t=await app.require(e);t&&typeof t.close=="function"&&t.close(o)}},n.closeAll=function(e){if(l)return;let o="[data-uuid]";e&&(o='[data-module="'+e+'"]'+o),n.tasklist.find(o).each(function(r,t){n.close(e||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},n.discard=function(e,o){if(l)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').remove(),b()},n.push=function(e,o,r,t){if(t=t||function(){},l)return t();const s=n.tasklist.find('li[data-uuid="'+o+'"]'),u={module:e,uuid:o,options:r,element:s};d.fire("filter:taskbar.push",u),!s.length&&u.module?m(u,t):t(s)},n.get=function(e){return l?[]:$('[data-module="'+e+'"]').map(function(r,t){return $(t).data()})},n.minimize=function(e,o){if(l)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').toggleClass("active",!1)},n.toggleNew=function(e,o,r){if(l)return;n.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",o),r||d.fire("action:taskbar.toggleNew",e)},n.updateActive=function(e){if(l)return;const o=n.tasklist.find("li");o.removeClass("active"),o.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},n.isActive=function(e){return l?!1:n.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function b(){if(l)return;n.tasklist.find("li").length>0?n.taskbar.attr("data-active","1"):n.taskbar.removeAttr("data-active")}function c(){l||n.tasklist.find(".active").removeClass("active")}function m(e,o){if(l)return o();p.translate(e.options.title,function(r){const t=$("<div></div>").text(r||"NodeBB Task").html(),s=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&c(),n.tasklist.append(s),b(),e.element=s,s.data(e),d.fire("action:taskbar.pushed",e),o(s)})}const g=function(e,o,r){switch(o){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return n.update=function(e,o,r){if(l)return;const t=n.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]');if(!t.length)return;const s=t.data();Object.keys(r).forEach(function(u){s[u]=r[u],g(t,u,r[u])}),t.data(s)},n}.apply(E,h),v!==void 0&&(x.exports=v)},62023:(x,E,a)=>{"use strict";var h,v;h=[a(74344),a(63281),a(7927),a(50431),a(59006),a(32230),a(62526)],v=function(p,d,n,l,b,c){const m={};return m.get=g=>p.get(`/topics/${g}/thumbs`,{}),m.getByPid=g=>p.get(`/posts/${g}`,{}).then(e=>m.get(e.tid)),m.delete=(g,e)=>p.del(`/topics/${g}/thumbs`,{path:e}),m.deleteAll=g=>{m.get(g).then(e=>{Promise.all(e.map(o=>m.delete(g,o.url)))})},m.upload=g=>new Promise(e=>{l.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${g}/thumbs`},function(o){e(o)})}),m.modal={},m.modal.open=function(g){const{id:e,pid:o}=g;let{modal:r}=g,t;return new Promise(s=>{Promise.all([m.get(e),o?m.getByPid(o):[]]).then(u=>new Promise(y=>{const A=u.reduce((k,w)=>k.concat(w));t=A.length,y(A)})).then(u=>b.render("modals/topic-thumbs",{thumbs:u})).then(u=>{r?c.translate(u,function(y){r.find(".bootbox-body").html(y),m.modal.handleSort({modal:r,numThumbs:t})}):(r=d.dialog({title:"[[modules:thumbs.modal.title]]",message:u,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(m.upload(e).then(()=>{m.modal.open({...g,modal:r}),Promise.all([a.e(61006),a.e(18099),a.e(10830),a.e(8311)]).then(function(){var y=[a(44541)];(A=>{A.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),s()}).apply(null,y)}).catch(a.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),m.modal.handleDelete({...g,modal:r}),m.modal.handleSort({modal:r,numThumbs:t}))})})},m.modal.handleDelete=g=>{g.modal.get(0).addEventListener("click",o=>{o.target.closest('button[data-action="remove"]')&&d.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const t=o.target.closest("[data-id]").getAttribute("data-id"),s=o.target.closest("[data-path]").getAttribute("data-path");p.del(`/topics/${t}/thumbs`,{path:s}).then(()=>{m.modal.open(g)}).catch(n.error)})})},m.modal.handleSort=({modal:g,numThumbs:e})=>{if(e>1){const o=g.find(".topic-thumbs-modal");o.sortable({items:"[data-id]"}),o.on("sortupdate",m.modal.handleSortChange)}},m.modal.handleSortChange=(g,e)=>{const o=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(o).forEach((r,t)=>{const s=r.getAttribute("data-id");let u=r.getAttribute("data-path");u=u.replace(new RegExp(`^${config.upload_url}`),""),p.put(`/topics/${s}/thumbs/order`,{path:u,order:t}).catch(n.error)})},m}.apply(E,h),v!==void 0&&(x.exports=v)},50431:(x,E,a)=>{"use strict";var h,v;h=[a(86569)],v=function(){const p={};p.show=function(c,m){const g=c.hasOwnProperty("fileSize")&&c.fileSize!==void 0?parseInt(c.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:c.hasOwnProperty("showHelp")&&c.showHelp!==void 0?c.showHelp:!0,fileSize:g,title:c.title||"[[global:upload-file]]",description:c.description||"",button:c.button||"[[global:upload]]",accept:c.accept?c.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const o=e.find("#uploadForm");o.attr("action",c.route),o.find("#params").val(JSON.stringify(c.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),o.submit()}),o.submit(function(){return d(e,g,m),!1})})},p.hideAlerts=function(c){$(c).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function d(c,m,g){n(c,"status","[[uploads:uploading-file]]"),c.find("#upload-progress-bar").css("width","0%"),c.find("#upload-progress-box").show().removeClass("hide");const e=c.find("#fileInput");if(!e.val())return n(c,"error","[[uploads:select-file-to-upload]]");if(!b(e[0],m))return n(c,"error","[[error:file-too-big, "+m+"]]");p.ajaxSubmit(c,g)}function n(c,m,g){p.hideAlerts(c),m==="error"&&c.find("#fileUploadSubmitBtn").removeClass("disabled"),g=g.replace(/&amp;#44/g,"&#44"),c.find("#alert-"+m).translateText(g).removeClass("hide")}p.ajaxSubmit=function(c,m){c.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=l(e),n(c,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,o,r,t){c.find("#upload-progress-bar").css("width",t+"%")},success:function(e){let o=l(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(o=e.response.images),m(o[0].url),n(c,"success","[[uploads:upload-success]]"),setTimeout(function(){p.hideAlerts(c),c.modal("hide")},750)}})};function l(c){if(typeof c=="string")try{return JSON.parse(c)}catch{return{error:"[[error:parse-error]]"}}return c}function b(c,m){return window.FileReader&&m?c.files[0].size<=m*1e3:!0}return p}.apply(E,h),v!==void 0&&(x.exports=v)},66485:(x,E,a)=>{"use strict";var h,v;h=[a(74344),a(7927)],v=function(p,d){const n={};n.init=function(e,o){const r=e.find(".draft-icon"),t=e.attr("data-uuid");function s(){$(`[component="composer"][data-uuid="${t}"]`).length&&(o.save_id||(o.save_id=utils.generateSaveId(app.user.uid)),n.addToDraftList("available",o.save_id),n.addToDraftList("open",o.save_id),c(e,r,o))}e.on("keyup","textarea, input.handle, input.title",utils.debounce(s,1e3)),e.on("click",'input[type="checkbox"]',utils.debounce(s,1e3)),e.on("click",'[component="category/list"] [data-cid]',utils.debounce(s,1e3)),e.on("itemAdded",".tags",utils.debounce(s,1e3)),e.on("thumb.uploaded",s),r.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const u=n.getList("open");u.length&&u.forEach(y=>n.removeFromDraftList("open",y))}),n.migrateGuest(),n.migrateThumbs(...arguments)};function b(e){return parseInt(e,10)>0?localStorage:sessionStorage}n.get=function(e){if(!e)return null;const o=e.split(":")[1],r=b(o);try{const t=r.getItem(e),s=JSON.parse(t)||null;if(!s)throw new Error(`can't parse draft json for ${e}`);return s.save_id=e,s.timestamp&&(s.timestampISO=utils.toISOString(s.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:s,storage:r}),s}catch{return console.warn(`[composer/drafts] Could not get draft ${e}, removing`),n.removeFromDraftList("available"),n.removeFromDraftList("open"),null}};function c(e,o,r){if(g(app.user.uid?"localStorage":"sessionStorage")&&r&&r.save_id&&e.length){const t=e.find("input.title"),s=t&&t.length&&t.val(),u=e.find("textarea").val(),y=b(app.user.uid);if(u.length||s&&s.length){const A={save_id:r.save_id,action:r.action,text:u,uuid:e.attr("data-uuid"),timestamp:Date.now()};if(r.action==="topics.post"){const k=e.find("input.tags").val();A.tags=k,A.title=s,A.cid=r.cid}else r.action==="posts.reply"?(A.title=r.title,A.tid=r.tid,A.toPid=r.toPid):r.action==="posts.edit"&&(A.pid=r.pid,A.title=s||r.title);app.user.uid||(A.handle=e.find("input.handle").val()),y.setItem(r.save_id,JSON.stringify(A)),$(window).trigger("action:composer.drafts.save",{storage:y,postData:r,postContainer:e}),o.toggleClass("active",!0)}else n.removeDraft(r.save_id)}}n.removeDraft=function(e){if(!e)return;n.removeFromDraftList("available",e),n.removeFromDraftList("open",e);const o=e.split(":")[1],r=b(o);r.removeItem(e),$(window).trigger("action:composer.drafts.remove",{storage:r,save_id:e})},n.getList=function(e){try{const o=localStorage.getItem(`drafts:${e}`);return JSON.parse(o)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},n.addToDraftList=function(e,o){if(!g(app.user.uid?"localStorage":"sessionStorage")||!o)return;const r=n.getList(e);r.includes(o)||(r.push(o),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.removeFromDraftList=function(e,o){if(!g(app.user.uid?"localStorage":"sessionStorage")||!o)return;const r=n.getList(e);r.includes(o)&&(r.splice(r.indexOf(o),1),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.migrateGuest=function(){if(g("localStorage")&&app.user.uid){const e=/^composer:\d+:\d$/,o=Object.keys(sessionStorage).filter(function(s){return e.test(s)}),r=new Set([]),t=o.map(function(s){const u=s.split(":");return u[1]=app.user.uid,r.add(u.join(":")),u.join(":")});return o.forEach(function(s,u){localStorage.setItem(t[u],sessionStorage.getItem(s)),sessionStorage.removeItem(s)}),r.forEach(function(s){n.addToDraftList("available",s)}),r}},n.migrateThumbs=function(e,o){if(!app.uid)return;const r=e.attr("data-uuid"),t=n.get(o.save_id);t&&t.uuid&&p.put(`/topics/${t.uuid}/thumbs`,{tid:r}).then(()=>{Promise.all([a.e(66177),a.e(62526),a.e(61006),a.e(18099),a.e(10830),a.e(59330)]).then(function(){var s=[a(44541)];(function(u){u.updateThumbCount(r,e)}).apply(null,s)}).catch(a.oe)})},n.listAvailable=function(){return n.getList("available").map(n.get)},n.getAvailableCount=function(){return n.listAvailable().length},n.open=function(e){if(!e)return;const o=n.get(e);m(e,o)},n.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const e=n.getList("available"),o=n.getList("open");e.length&&e.forEach(function(r){if(!r||o.includes(r))return;const t=n.get(r);if(!t||!t.text&&!t.title){n.removeFromDraftList("available",r),n.removeFromDraftList("open",r);return}m(r,t)})};function m(e,o){const t=e.split(":")[1];parseInt(app.user.uid,10)===parseInt(t,10)&&Promise.all([a.e(66177),a.e(62526),a.e(61006),a.e(18099),a.e(10830),a.e(59330)]).then(function(){var s=[a(44541)];(function(u){o.action==="topics.post"?u.newTopic({save_id:o.save_id,cid:o.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(o.handle),title:utils.escapeHTML(o.title),body:o.text,tags:String(o.tags||"").split(",")}):o.action==="posts.reply"?p.get("/topics/"+o.tid,{},function(y,A){if(y)return d.error(y);u.newReply({save_id:o.save_id,tid:o.tid,toPid:o.toPid,title:A.title,body:o.text})}):o.action==="posts.edit"&&u.editPost({save_id:o.save_id,pid:o.pid,title:o.title?utils.escapeHTML(o.title):void 0,body:o.text})}).apply(null,s)}).catch(a.oe)}function g(e){var o;try{o=window[e];var r="__storage_test__";return o.setItem(r,r),o.removeItem(r),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&o&&o.length!==0}}return n}.apply(E,h),v!==void 0&&(x.exports=v)},35729:(x,E,a)=>{"use strict";var h,v;h=[a(83713),a(38259),a(62023),a(10577)],v=function(p,d,n,l){var b={},c={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){b.exitFullscreen();var e=this;Promise.all([a.e(61006),a.e(18099),a.e(10830),a.e(92497)]).then(function(){var o=[a(44541)];(function(r){const t=e.get(0).getAttribute("data-uuid"),s=r.posts[t];(s.action==="topics.post"||s.action==="posts.edit"&&s.isMain)&&n.modal.open({id:t,pid:s.pid}).then(()=>{e.trigger("thumb.uploaded"),r.updateThumbCount(t,e)})}).apply(null,o)}).catch(a.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function o(){l.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),d.reposition(e),$(window).off("resize",o))}l.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",o),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",l.exit))}),l.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},m=[];b.exitFullscreen=function(){l.isEnabled&&l.isFullscreen&&l.exit()},b.addComposerButtons=function(){const e=$(".formatting-bar"),o=e.find(".formatting-group #fileForm");m.forEach(t=>{let s="";Array.isArray(t.dropdownItems)&&t.dropdownItems.length?s=g(t):s=`
					<li data-format="${t.name}" title="${t.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${t.iconClass}"></i>
					</li>
				`,o.before(s)}),e.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(t){const s=$(t.target);s.hasClass("dropdown-menu")||!!s.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function g(e){const o=e.dropdownItems.map(function(r){let t="";return r.badge&&(t='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${r.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${r.iconClass} text-secondary"></i> ${r.text}
						${t}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${e.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" >
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${o}
				</ul>
			</li>
		`}return b.addButton=function(e,o,r,t){t=t||e.replace("fa fa-",""),c[t]=o,m.push({name:t,iconClass:e,title:r})},b.addDropdown=function(e){m.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(o=>{o.name&&o.onClick&&(c[o.name]=o.onClick)})},b.getDispatchTable=function(){return c},b.addButtonDispatch=function(e,o){c[e]=o},b.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(o){var r=$(this).attr("data-format"),t=$(this).parents('[component="composer"]').find("textarea")[0];c.hasOwnProperty(r)&&(c[r].call(e,t,t.selectionStart,t.selectionEnd,o),p.render(e))})},b}.apply(E,h),v!==void 0&&(x.exports=v)},51077:(x,E,a)=>{"use strict";var h,v;h=[a(85233)],v=function(p){var d={};return d.render=function(n,l){if(l=l||function(){},!n.find(".preview-container").is(":visible"))return l();var b=n.find("textarea");socket.emit("plugins.composer.renderPreview",b.val(),function(c,m){c||(m=$("<div>"+m+"</div>"),m.find("img:not(.not-responsive)").addClass("img-fluid"),n.find(".preview").html(m),p.fire("action:composer.preview",{postContainer:n,preview:m}),l())})},d.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var l=n.find("textarea"),b=n.find(".preview");if(l.length&&b.length){var c=l[0].scrollHeight-l.height();if(c===0)return;var m=l.scrollTop()/c;b.scrollTop(Math.max(b[0].scrollHeight-b.height(),0)*m)}}},d.handleToggler=function(n){const l=n.get(0);d.env=utils.findBootstrapEnvironment();const b=["xs","sm"].includes(d.env),c=l.querySelector('.formatting-bar [data-action="preview"]'),m=c.querySelector(".show-text"),g=c.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),o=config["composer-default"].hidePreviewOnOpen==="on";let r=!b&&(e===null&&!o||e==="true");const t=l.querySelector(".preview-container"),s=l.querySelector(".write-container");if(!c)return;function u(y){b?(t.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),t.classList.toggle("d-none",!y),t.classList.toggle("d-flex",y),t.classList.toggle("w-100",y),s.classList.toggle("d-flex",!y),s.classList.toggle("d-none",y),s.classList.toggle("w-100",!y)):(t.classList.toggle("hide",!y),s.classList.toggle("w-50",y),s.classList.toggle("w-100",!y),localStorage.setItem("composer:previewToggled",y)),m.classList.toggle("hide",y),g.classList.toggle("hide",!y),y&&d.render(n),d.matchScroll(n)}d.toggle=u,c.addEventListener("click",y=>{y.button===0&&(r=!r,u(r))}),u(r)},d}.apply(E,h),v!==void 0&&(x.exports=v)},65616:(x,E,a)=>{"use strict";var h,v;h=[a(27145)],v=function(p){var d={},n=0,l=.3,b=.05,c=768,m=$("body"),g=$(window),e=$('[component="navbar"]');const o=document.getElementById("content");var r=e[0];function t(){return localStorage.getItem("composer:resizeRatio")||.5}function s(w){localStorage.setItem("composer:resizeRatio",Math.min(w,1))}function u(){var w;r?w=r.getBoundingClientRect():w={bottom:0};var I=Math.max(w.bottom,0),D={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return D.width=D.right,D.height=D.bottom,D.boundedTop=I,D.boundedHeight=D.bottom-I,D}function y(w,I){var D=u(),F=w[0],M=window.getComputedStyle(F),U=parseInt(M.getPropertyValue("min-height"),10),O=Math.max(U/window.innerHeight,l);if(D.width>=c){const W=(D.height-D.boundedHeight)/D.height;I=Math.min(Math.max(I,O+W),1);var B=I*D.boundedHeight/D.height;F.style.top=((1-B)*100).toString()+"%";var T=F.getBoundingClientRect();o.style.paddingBottom=(T.bottom-T.top).toString()+"px"}else F.style.top=0,o.style.paddingBottom=0;w.ratio=I,p.updateActive(w.attr("data-uuid"))}var A=y,k=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return k&&(A=function(w,I){k(function(){y(w,I),setTimeout(function(){g.trigger("action:composer.resize"),w.trigger("action:composer.resize")},0)})}),d.reposition=function(w){var I=t();I>=1-b&&(I=1,w.addClass("maximized")),A(w,I)},d.maximize=function(w,I){I?A(w,1):d.reposition(w)},d.handleResize=function(w){var I=0,D=0,F=0,M=w.find(".resizer"),U=M[0];function O(C){var i=U.getBoundingClientRect(),f=(i.top+i.bottom)/2;I=(f-C.clientY)/2,D=C.clientY,g.on("mousemove",B),g.on("mouseup",T),m.on("touchmove",W)}function B(C){var i=C.clientY-I,f=u(),S=(f.height-i)/f.boundedHeight;A(w,S)}function T(C){C.preventDefault(),F=C.clientY,w.find("textarea").focus(),g.off("mousemove",B),g.off("mouseup",T),m.off("touchmove",W);var i=F-I,f=u(),S=(f.height-i)/f.boundedHeight;F-D===0&&w.hasClass("maximized")?(w.removeClass("maximized"),S=!n||n>=1-b?.5:n,A(w,S)):F-D===0||S>=1-b?(A(w,1),w.addClass("maximized"),n=S):w.removeClass("maximized"),s(S)}function W(C){C.preventDefault(),B(C.touches[0])}M.on("mousedown",function(C){C.button===0&&(C.preventDefault(),O(C))}).on("touchstart",function(C){C.preventDefault(),O(C.touches[0])}).on("touchend",T)},d}.apply(E,h),v!==void 0&&(x.exports=v)},10577:x=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},a=x.exports,h=function(){for(var d,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],l=0,b=n.length,c={};l<b;l++)if(d=n[l],d&&d[1]in E){for(l=0;l<d.length;l++)c[n[0][l]]=d[l];return c}return!1}(),v={change:h.fullscreenchange,error:h.fullscreenerror},p={request:function(d,n){return new Promise(function(l,b){var c=function(){this.off("change",c),l()}.bind(this);this.on("change",c),d=d||E.documentElement;var m=d[h.requestFullscreen](n);m instanceof Promise&&m.then(c).catch(b)}.bind(this))},exit:function(){return new Promise(function(d,n){if(!this.isFullscreen){d();return}var l=function(){this.off("change",l),d()}.bind(this);this.on("change",l);var b=E[h.exitFullscreen]();b instanceof Promise&&b.then(l).catch(n)}.bind(this))},toggle:function(d,n){return this.isFullscreen?this.exit():this.request(d,n)},onchange:function(d){this.on("change",d)},onerror:function(d){this.on("error",d)},on:function(d,n){var l=v[d];l&&E.addEventListener(l,n,!1)},off:function(d,n){var l=v[d];l&&E.removeEventListener(l,n,!1)},raw:h};if(!h){a?x.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(p,{isFullscreen:{get:function(){return!!E[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return E[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!E[h.fullscreenEnabled]}}}),a?x.exports=p:window.screenfull=p})()}}]);
