(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[59330,38786,62735,10882,28306,43034,3564],{45482:(b,w,c)=>{b.exports=c(35729)},83713:(b,w,c)=>{b.exports=c(51077)},38259:(b,w,c)=>{b.exports=c(65616)},66603:(b,w,c)=>{"use strict";var p;p=function(){function g(){this._store={},this._keys=[]}g.prototype.isMock=!0,g.prototype.setItem=function(t,o){t=String(t),this._keys.indexOf(t)===-1&&this._keys.push(t),this._store[t]=o},g.prototype.getItem=function(t){return t=String(t),this._keys.indexOf(t)===-1?null:this._store[t]},g.prototype.removeItem=function(t){t=String(t),this._keys=this._keys.filter(function(o){return o!==t}),this._store[t]=null},g.prototype.clear=function(){this._keys=[],this._store={}},g.prototype.key=function(t){return t=parseInt(t,10)||0,this._keys[t]},Object.defineProperty&&Object.defineProperty(g.prototype,"length",{get:function(){return this._keys.length}});let m;const a=Date.now().toString();try{if(m=window.localStorage,m.setItem(a,a),m.getItem(a)!==a)throw Error("localStorage behaved unexpectedly");return m.removeItem(a),m}catch(t){console.warn(t),console.warn("localStorage failed, falling back on sessionStorage");try{if(m=window.sessionStorage,m.setItem(a,a),m.getItem(a)!==a)throw Error("sessionStorage behaved unexpectedly");return m.removeItem(a),m}catch(o){return console.warn(o),console.warn("sessionStorage failed, falling back on memory storage"),new g}}}.call(w,c,w,b),p!==void 0&&(b.exports=p)},27145:(b,w,c)=>{"use strict";b=c.nmd(b);var p,g;p=[c(32230),c(85233)],g=function(m,a){const t={};let o=!1;t.init=function(){if(t.taskbar=$('[component="taskbar"]'),t.tasklist=t.taskbar.find("ul"),!t.taskbar.length||!t.tasklist.length){o=!0;return}t.taskbar.on("click","li",async function(){const e=$(this),n=e.attr("data-module"),r=e.attr("data-uuid"),s=await app.require(n);return e.hasClass("active")?s.minimize(r):(i(),s.load(r),t.toggleNew(r,!1),t.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){t.closeAll()})},t.close=async function(e,n){if(o)return;if(t.tasklist.find('[data-module="'+b+'"][data-uuid="'+n+'"]').length){const s=await app.require(e);s&&typeof s.close=="function"&&s.close(n)}},t.closeAll=function(e){if(o)return;let n="[data-uuid]";e&&(n='[data-module="'+e+'"]'+n),t.tasklist.find(n).each(function(r,s){t.close(e||s.getAttribute("data-module"),s.getAttribute("data-uuid"))})},t.discard=function(e,n){if(o)return;t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').remove(),f()},t.push=function(e,n,r,s){if(s=s||function(){},o)return s();const d=t.tasklist.find('li[data-uuid="'+n+'"]'),v={module:e,uuid:n,options:r,element:d};a.fire("filter:taskbar.push",v),!d.length&&v.module?l(v,s):s(d)},t.get=function(e){return o?[]:$('[data-module="'+e+'"]').map(function(r,s){return $(s).data()})},t.minimize=function(e,n){if(o)return;t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},t.toggleNew=function(e,n,r){if(o)return;t.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",n),r||a.fire("action:taskbar.toggleNew",e)},t.updateActive=function(e){if(o)return;const n=t.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},t.isActive=function(e){return o?!1:t.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function f(){if(o)return;t.tasklist.find("li").length>0?t.taskbar.attr("data-active","1"):t.taskbar.removeAttr("data-active")}function i(){o||t.tasklist.find(".active").removeClass("active")}function l(e,n){if(o)return n();m.translate(e.options.title,function(r){const s=$("<div></div>").text(r||"NodeBB Task").html(),d=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+s+'" component="taskbar/title">'+s+"</span></a>").attr({title:s,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&i(),t.tasklist.append(d),f(),e.element=d,d.data(e),a.fire("action:taskbar.pushed",e),n(d)})}const u=function(e,n,r){switch(n){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return t.update=function(e,n,r){if(o)return;const s=t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]');if(!s.length)return;const d=s.data();Object.keys(r).forEach(function(v){d[v]=r[v],u(s,v,r[v])}),s.data(d)},t}.apply(w,p),g!==void 0&&(b.exports=g)},62023:(b,w,c)=>{"use strict";var p,g;p=[c(74344),c(63281),c(7927),c(50431),c(59006),c(32230),c(62526)],g=function(m,a,t,o,f,i){const l={};return l.get=u=>m.get(`/topics/${u}/thumbs`,{}),l.getByPid=u=>m.get(`/posts/${u}`,{}).then(e=>l.get(e.tid)),l.delete=(u,e)=>m.del(`/topics/${u}/thumbs`,{path:e}),l.deleteAll=u=>{l.get(u).then(e=>{Promise.all(e.map(n=>l.delete(u,n.url)))})},l.upload=u=>new Promise(e=>{o.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${u}/thumbs`},function(n){e(n)})}),l.modal={},l.modal.open=function(u){const{id:e,pid:n}=u;let{modal:r}=u,s;return new Promise(d=>{Promise.all([l.get(e),n?l.getByPid(n):[]]).then(v=>new Promise(E=>{const F=v.reduce((D,h)=>D.concat(h));s=F.length,E(F)})).then(v=>f.render("modals/topic-thumbs",{thumbs:v})).then(v=>{r?i.translate(v,function(E){r.find(".bootbox-body").html(E),l.modal.handleSort({modal:r,numThumbs:s})}):(r=a.dialog({title:"[[modules:thumbs.modal.title]]",message:v,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(l.upload(e).then(()=>{l.modal.open({...u,modal:r}),Promise.all([c.e(61006),c.e(18099),c.e(10830),c.e(8311)]).then(function(){var E=[c(44541)];(F=>{F.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),d()}).apply(null,E)}).catch(c.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),l.modal.handleDelete({...u,modal:r}),l.modal.handleSort({modal:r,numThumbs:s}))})})},l.modal.handleDelete=u=>{u.modal.get(0).addEventListener("click",n=>{n.target.closest('button[data-action="remove"]')&&a.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const s=n.target.closest("[data-id]").getAttribute("data-id"),d=n.target.closest("[data-path]").getAttribute("data-path");m.del(`/topics/${s}/thumbs`,{path:d}).then(()=>{l.modal.open(u)}).catch(t.error)})})},l.modal.handleSort=({modal:u,numThumbs:e})=>{if(e>1){const n=u.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",l.modal.handleSortChange)}},l.modal.handleSortChange=(u,e)=>{const n=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((r,s)=>{const d=r.getAttribute("data-id");let v=r.getAttribute("data-path");v=v.replace(new RegExp(`^${config.upload_url}`),""),m.put(`/topics/${d}/thumbs/order`,{path:v,order:s}).catch(t.error)})},l}.apply(w,p),g!==void 0&&(b.exports=g)},50431:(b,w,c)=>{"use strict";var p,g;p=[c(86569)],g=function(){const m={};m.show=function(i,l){const u=i.hasOwnProperty("fileSize")&&i.fileSize!==void 0?parseInt(i.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:i.hasOwnProperty("showHelp")&&i.showHelp!==void 0?i.showHelp:!0,fileSize:u,title:i.title||"[[global:upload-file]]",description:i.description||"",button:i.button||"[[global:upload]]",accept:i.accept?i.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const n=e.find("#uploadForm");n.attr("action",i.route),n.find("#params").val(JSON.stringify(i.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return a(e,u,l),!1})})},m.hideAlerts=function(i){$(i).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function a(i,l,u){t(i,"status","[[uploads:uploading-file]]"),i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide");const e=i.find("#fileInput");if(!e.val())return t(i,"error","[[uploads:select-file-to-upload]]");if(!f(e[0],l))return t(i,"error","[[error:file-too-big, "+l+"]]");m.ajaxSubmit(i,u)}function t(i,l,u){m.hideAlerts(i),l==="error"&&i.find("#fileUploadSubmitBtn").removeClass("disabled"),u=u.replace(/&amp;#44/g,"&#44"),i.find("#alert-"+l).translateText(u).removeClass("hide")}m.ajaxSubmit=function(i,l){i.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=o(e),t(i,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,n,r,s){i.find("#upload-progress-bar").css("width",s+"%")},success:function(e){let n=o(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(n=e.response.images),l(n[0].url),t(i,"success","[[uploads:upload-success]]"),setTimeout(function(){m.hideAlerts(i),i.modal("hide")},750)}})};function o(i){if(typeof i=="string")try{return JSON.parse(i)}catch{return{error:"[[error:parse-error]]"}}return i}function f(i,l){return window.FileReader&&l?i.files[0].size<=l*1e3:!0}return m}.apply(w,p),g!==void 0&&(b.exports=g)},35729:(b,w,c)=>{"use strict";var p,g;p=[c(83713),c(38259),c(62023),c(10577)],g=function(m,a,t,o){var f={},i={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){f.exitFullscreen();var e=this;Promise.all([c.e(61006),c.e(18099),c.e(10830),c.e(92497)]).then(function(){var n=[c(44541)];(function(r){const s=e.get(0).getAttribute("data-uuid"),d=r.posts[s];(d.action==="topics.post"||d.action==="posts.edit"&&d.isMain)&&t.modal.open({id:s,pid:d.pid}).then(()=>{e.trigger("thumb.uploaded"),r.updateThumbCount(s,e)})}).apply(null,n)}).catch(c.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function n(){o.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),a.reposition(e),$(window).off("resize",n))}o.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",n),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",o.exit))}),o.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},l=[];f.exitFullscreen=function(){o.isEnabled&&o.isFullscreen&&o.exit()},f.addComposerButtons=function(){const e=$(".formatting-bar"),n=e.find(".formatting-group #fileForm");l.forEach(s=>{let d="";Array.isArray(s.dropdownItems)&&s.dropdownItems.length?d=u(s):d=`
					<li data-format="${s.name}" title="${s.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${s.iconClass}"></i>
					</li>
				`,n.before(d)}),e.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(s){const d=$(s.target);d.hasClass("dropdown-menu")||!!d.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function u(e){const n=e.dropdownItems.map(function(r){let s="";return r.badge&&(s='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${r.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${r.iconClass} text-secondary"></i> ${r.text}
						${s}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${e.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" >
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${n}
				</ul>
			</li>
		`}return f.addButton=function(e,n,r,s){s=s||e.replace("fa fa-",""),i[s]=n,l.push({name:s,iconClass:e,title:r})},f.addDropdown=function(e){l.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(n=>{n.name&&n.onClick&&(i[n.name]=n.onClick)})},f.getDispatchTable=function(){return i},f.addButtonDispatch=function(e,n){i[e]=n},f.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(n){var r=$(this).attr("data-format"),s=$(this).parents('[component="composer"]').find("textarea")[0];i.hasOwnProperty(r)&&(i[r].call(e,s,s.selectionStart,s.selectionEnd,n),m.render(e))})},f}.apply(w,p),g!==void 0&&(b.exports=g)},51077:(b,w,c)=>{"use strict";var p,g;p=[c(85233)],g=function(m){var a={};return a.render=function(t,o){if(o=o||function(){},!t.find(".preview-container").is(":visible"))return o();var f=t.find("textarea");socket.emit("plugins.composer.renderPreview",f.val(),function(i,l){i||(l=$("<div>"+l+"</div>"),l.find("img:not(.not-responsive)").addClass("img-fluid"),t.find(".preview").html(l),m.fire("action:composer.preview",{postContainer:t,preview:l}),o())})},a.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var o=t.find("textarea"),f=t.find(".preview");if(o.length&&f.length){var i=o[0].scrollHeight-o.height();if(i===0)return;var l=o.scrollTop()/i;f.scrollTop(Math.max(f[0].scrollHeight-f.height(),0)*l)}}},a.handleToggler=function(t){const o=t.get(0);a.env=utils.findBootstrapEnvironment();const f=["xs","sm"].includes(a.env),i=o.querySelector('.formatting-bar [data-action="preview"]'),l=i.querySelector(".show-text"),u=i.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),n=config["composer-default"].hidePreviewOnOpen==="on";let r=!f&&(e===null&&!n||e==="true");const s=o.querySelector(".preview-container"),d=o.querySelector(".write-container");if(!i)return;function v(E){f?(s.classList.toggle("hide",!1),d.classList.toggle("maximized",!1),s.classList.toggle("d-none",!E),s.classList.toggle("d-flex",E),s.classList.toggle("w-100",E),d.classList.toggle("d-flex",!E),d.classList.toggle("d-none",E),d.classList.toggle("w-100",!E)):(s.classList.toggle("hide",!E),d.classList.toggle("w-50",E),d.classList.toggle("w-100",!E),localStorage.setItem("composer:previewToggled",E)),l.classList.toggle("hide",E),u.classList.toggle("hide",!E),E&&a.render(t),a.matchScroll(t)}a.toggle=v,i.addEventListener("click",E=>{E.button===0&&(r=!r,v(r))}),v(r)},a}.apply(w,p),g!==void 0&&(b.exports=g)},65616:(b,w,c)=>{"use strict";var p,g;p=[c(27145)],g=function(m){var a={},t=0,o=.3,f=.05,i=768,l=$("body"),u=$(window),e=$('[component="navbar"]');const n=document.getElementById("content");var r=e[0];function s(){return localStorage.getItem("composer:resizeRatio")||.5}function d(h){localStorage.setItem("composer:resizeRatio",Math.min(h,1))}function v(){var h;r?h=r.getBoundingClientRect():h={bottom:0};var A=Math.max(h.bottom,0),x={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return x.width=x.right,x.height=x.bottom,x.boundedTop=A,x.boundedHeight=x.bottom-A,x}function E(h,A){var x=v(),k=h[0],I=window.getComputedStyle(k),T=parseInt(I.getPropertyValue("min-height"),10),B=Math.max(T/window.innerHeight,o);if(x.width>=i){const N=(x.height-x.boundedHeight)/x.height;A=Math.min(Math.max(A,B+N),1);var P=A*x.boundedHeight/x.height;k.style.top=((1-P)*100).toString()+"%";var z=k.getBoundingClientRect();n.style.paddingBottom=(z.bottom-z.top).toString()+"px"}else k.style.top=0,n.style.paddingBottom=0;h.ratio=A,m.updateActive(h.attr("data-uuid"))}var F=E,D=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return D&&(F=function(h,A){D(function(){E(h,A),setTimeout(function(){u.trigger("action:composer.resize"),h.trigger("action:composer.resize")},0)})}),a.reposition=function(h){var A=s();A>=1-f&&(A=1,h.addClass("maximized")),F(h,A)},a.maximize=function(h,A){A?F(h,1):a.reposition(h)},a.handleResize=function(h){var A=0,x=0,k=0,I=h.find(".resizer"),T=I[0];function B(S){var R=T.getBoundingClientRect(),y=(R.top+R.bottom)/2;A=(y-S.clientY)/2,x=S.clientY,u.on("mousemove",P),u.on("mouseup",z),l.on("touchmove",N)}function P(S){var R=S.clientY-A,y=v(),C=(y.height-R)/y.boundedHeight;F(h,C)}function z(S){S.preventDefault(),k=S.clientY,h.find("textarea").focus(),u.off("mousemove",P),u.off("mouseup",z),l.off("touchmove",N);var R=k-A,y=v(),C=(y.height-R)/y.boundedHeight;k-x===0&&h.hasClass("maximized")?(h.removeClass("maximized"),C=!t||t>=1-f?.5:t,F(h,C)):k-x===0||C>=1-f?(F(h,1),h.addClass("maximized"),t=C):h.removeClass("maximized"),d(C)}function N(S){S.preventDefault(),P(S.touches[0])}I.on("mousedown",function(S){S.button===0&&(S.preventDefault(),B(S))}).on("touchstart",function(S){S.preventDefault(),B(S.touches[0])}).on("touchend",z)},a}.apply(w,p),g!==void 0&&(b.exports=g)},10577:b=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},c=b.exports,p=function(){for(var a,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],o=0,f=t.length,i={};o<f;o++)if(a=t[o],a&&a[1]in w){for(o=0;o<a.length;o++)i[t[0][o]]=a[o];return i}return!1}(),g={change:p.fullscreenchange,error:p.fullscreenerror},m={request:function(a,t){return new Promise(function(o,f){var i=function(){this.off("change",i),o()}.bind(this);this.on("change",i),a=a||w.documentElement;var l=a[p.requestFullscreen](t);l instanceof Promise&&l.then(i).catch(f)}.bind(this))},exit:function(){return new Promise(function(a,t){if(!this.isFullscreen){a();return}var o=function(){this.off("change",o),a()}.bind(this);this.on("change",o);var f=w[p.exitFullscreen]();f instanceof Promise&&f.then(o).catch(t)}.bind(this))},toggle:function(a,t){return this.isFullscreen?this.exit():this.request(a,t)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,t){var o=g[a];o&&w.addEventListener(o,t,!1)},off:function(a,t){var o=g[a];o&&w.removeEventListener(o,t,!1)},raw:p};if(!p){c?b.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(m,{isFullscreen:{get:function(){return!!w[p.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[p.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[p.fullscreenEnabled]}}}),c?b.exports=m:window.screenfull=m})()}}]);
