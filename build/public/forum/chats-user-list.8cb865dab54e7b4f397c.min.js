"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[76956,70565,83014,99617],{75208:(b,m,c)=>{var p,y;p=[c(74344)],y=function(g){const f={};let i=0;f.init=function(r,a){const s=a.find('[component="chat/user/list"]');if(!s.length)return;const l=a.find('[component="chat/messages/pinned/container"]');a.find('[component="chat/user/list/btn"]').on("click",()=>{s.toggleClass("hidden"),s.hasClass("hidden")?h():(l.addClass("hidden"),d(r,s))}),$(window).off("action:ajaxify.start",h).one("action:ajaxify.start",h),f.addInfiniteScrollHandler(r,s,async(u,t)=>{u.append(await app.parseAndTranslate("partials/chats/user-list","users",t))})};function d(r,a){i&&clearInterval(i),i=setInterval(()=>{_(r,a)},5e3)}function h(){i&&(clearInterval(i),i=0)}async function _(r,a){if(ajaxify.data.template.chats&&app.isFocused&&a.scrollTop()===0&&!a.hasClass("hidden")){const s=await g.get(`/chats/${r}/users`,{start:0});a.find('[data-bs-toggle="tooltip"]').tooltip("dispose"),a.html(await app.parseAndTranslate("partials/chats/user-list","users",s)),a.find('[data-bs-toggle="tooltip"]').tooltip()}}return f.addInfiniteScrollHandler=function(r,a,s){a.on("scroll",utils.debounce(async()=>{const l=(a[0].scrollHeight-a.height())*.85;if(a.scrollTop()>l){const u=a.find("[data-index]").last().attr("data-index"),t=await g.get(`/chats/${r}/users`,{start:parseInt(u,10)+1});t&&t.users.length&&s(a,t)}},200))},f.addSearchHandler=function(r,a,s){a.on("keyup",utils.debounce(async()=>{const l=a.val(),u=await socket.emit("modules.chats.searchMembers",{username:l,roomId:r});s(u)},200))},f}.apply(m,p),y!==void 0&&(b.exports=y)},74344:(b,m,c)=>{c.r(m),c.d(m,{del:()=>u,get:()=>_,head:()=>r,patch:()=>s,post:()=>a,put:()=>l});var p=c(85233),y=c.n(p),g=c(63281),f=c.n(g);const i=config.relative_path+"/api/v3";async function d(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:i+t.url,typeof n=="function"){h(t).then(e=>n(null,e),e=>n(e));return}try{return await h(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again.")return(0,g.confirm)("[[error:api.reauth-required]]",w=>{w&&ajaxify.go("login")});throw e}}async function h(t){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,p.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(n,t),{headers:w}=e,v=w.get("content-type"),x=v&&v.startsWith("application/json");let o;if(t.method!=="head"&&(x?o=await e.json():o=await e.text()),!e.ok)throw o?new Error(x?o.status.message:o):new Error(e.statusText);return x&&o&&o.hasOwnProperty("status")&&o.hasOwnProperty("response")?o.response:o}function _(t,n,e){return d({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function r(t,n,e){return d({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},e)}function a(t,n,e){return d({url:t,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function s(t,n,e){return d({url:t,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function l(t,n,e){return d({url:t,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function u(t,n,e){return d({url:t,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
