"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[41375,53375,16922,82586],{25142:(N,b,i)=>{var D,A;D=[i(85233),i(7927)],A=function(d,m){const v={};let k,h=0,g=!1,M,E=0;v.init=function(c,r){const y=$("body");typeof c=="function"?(k=c,M=y):(k=r,M=c||y),h=$(window).scrollTop(),$(window).off("scroll",w).on("scroll",w),y.height()<=$(window).height()&&k(1)};function w(){E&&clearTimeout(E),E=setTimeout(function(){E=0,a()},60)}function a(){const c=utils.findBootstrapEnvironment(),r=(c==="xs"||c==="sm")&&$("html").hasClass("composing");if(g||r||app.flags._glance)return;const y=$(window).scrollTop(),o=$(window).height(),n=M.height()-o,l=M.offset()?M.offset().top:0,s=100*(y-l)/(n<=0?o:n),p=15,P=85,j=y>h?1:-1;(s<p&&y<h||s>P&&y>h||s<0&&j>0&&n<0)&&k(j),h=y}return v.loadMore=function(c,r,y){if(g)return;g=!0;const o={method:c,data:r};d.fire("action:infinitescroll.loadmore",o),socket.emit(o.method,o.data,function(n,l){if(n)return g=!1,m.error(n);y(l,function(){g=!1})})},v.loadMoreXhr=function(c,r){if(g)return;g=!0;const y=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),o={url:y,data:c};d.fire("action:infinitescroll.loadmore.xhr",o),$.get(y,c,function(n){r(n,function(){g=!1})}).fail(function(n){g=!1,m.error(String(n.responseJSON||"[[error:no-connection]]"))})},v.removeExtra=function(c,r,y){let o=$();if(c.length<=y)return o;const n=c.length-y;if(r>0){const l=$(document).height(),s=$(window).scrollTop();o=c.slice(0,n).remove(),$(window).scrollTop(s+($(document).height()-l))}else o=c.slice(c.length-n).remove();return o},v}.apply(b,D),A!==void 0&&(N.exports=A)},47720:(N,b)=>{var i,D;i=[],D=function(){const A={},d=/-resized(\.[\w]+)?$/;return A.wrapImagesInLinks=function(m){m.find('[component="post/content"] img:not(.emoji)').each(function(){A.wrapImageInLink($(this))})},A.wrapImageInLink=function(m){let v=m.attr("src")||"";if(v!=="about:blank"&&!m.parent().is("a")){utils.isRelativeUrl(v)&&d.test(v)&&(v=v.replace(d,"$1"));const k=m.attr("alt")||"",h=v.split(".").slice(1).pop(),g=k.split("/").pop(),M=g.split(".").slice(1).pop();m.wrap('<a href="'+v+'" '+(!h&&M?' download="'+utils.escapeHTML(g)+'" ':"")+' target="_blank" rel="noopener">')}},A}.apply(b,i),D!==void 0&&(N.exports=D)},60447:(N,b,i)=>{var D,A;D=[i(78989),i(25142),i(54939),i(47720),i(42840),i(7237),i(32230),i(85233),i(59265)],A=function(d,m,v,k,h,g,M,E,w){const a={};a.signaturesShown={};const c=$(window);a.onNewPost=function(t){!t||!t.posts||!t.posts.length||parseInt(t.posts[0].tid,10)!==parseInt(ajaxify.data.tid,10)||(t.loggedIn=!!app.user.uid,t.privileges=ajaxify.data.privileges,t.posts[0].timestamp=t.posts[0].topic.scheduled?t.posts[0].timestamp:Date.now()-1e3,t.posts[0].timestampISO=utils.toISOString(t.posts[0].timestamp),a.modifyPostsByPrivileges(t.posts),y(t.posts),r(t.posts[0]),o(t.posts),ajaxify.data.postcount+=1,v.updatePostCount(ajaxify.data.postcount),config.usePagination?n(t):s(t),i.e(21352).then(function(){var e=[i(21352)];(function(f){f.onNewPost(t)}).apply(null,e)}).catch(i.oe))};function r(t){$(".pagination-block .pagebottom .timeago").timeago("update",t.timestampISO)}a.modifyPostsByPrivileges=function(t){t.forEach(function(e){e.selfPost=!!app.user.uid&&parseInt(e.uid,10)===parseInt(app.user.uid,10),e.topicOwnerPost=parseInt(e.uid,10)===parseInt(ajaxify.data.uid,10),e.display_edit_tools=ajaxify.data.privileges["posts:edit"]&&e.selfPost||ajaxify.data.privileges.isAdminOrMod,e.display_delete_tools=ajaxify.data.privileges["posts:delete"]&&e.selfPost||ajaxify.data.privileges.isAdminOrMod,e.display_moderator_tools=e.display_edit_tools||e.display_delete_tools,e.display_move_tools=ajaxify.data.privileges.isAdminOrMod,e.display_post_menu=ajaxify.data.privileges.isAdminOrMod||e.selfPost&&!ajaxify.data.locked&&!e.deleted||e.selfPost&&e.deleted&&parseInt(e.deleterUid,10)===parseInt(app.user.uid,10)||(app.user.uid||ajaxify.data.postSharing.length)&&!e.deleted})};function y(t){for(let e=0;e<t.length;e+=1){const f=g.get("user/postcount",t[e].uid);f.html(w.formattedNumber(parseInt(f.attr("data-postcount"),10)+1))}}function o(t){config.topicPostSort==="newest_to_oldest"&&(t[0].index=1,g.get("post").not("[data-index=0]").each(function(){const e=parseInt($(this).attr("data-index"),10)+1;$(this).attr("data-index",e)}))}function n(t){function e(){p(t.posts[0])}const f=t.posts;ajaxify.data.pagination.pageCount=Math.max(1,Math.ceil(f[0].topic.postcount/config.postsPerPage));const u=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1;if(ajaxify.data.pagination.currentPage===ajaxify.data.pagination.pageCount&&u===1||ajaxify.data.pagination.currentPage===1&&u===-1){const R=$('[component="post"]:not([data-index=0]), [component="topic/event"]');P(t,R,u,!1,e)}else ajaxify.data.scrollToMyPost&&parseInt(f[0].uid,10)===parseInt(app.user.uid,10)?setTimeout(function(){d.loadPage(ajaxify.data.pagination.pageCount,e)},250):l()}function l(){$.get(config.relative_path+"/api/topic/pagination/"+ajaxify.data.tid,{page:ajaxify.data.pagination.currentPage},function(t){app.parseAndTranslate("partials/paginator",t,function(e){$('[component="pagination"]').after(e).remove()})})}function s(t){const e=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1,f=$('[component="post"][data-index="'+(t.posts[0].index-1)+'"]').length;if(!f&&(!t.posts[0].selfPost||!ajaxify.data.scrollToMyPost))return;if(!f&&t.posts[0].selfPost)return ajaxify.go("post/"+t.posts[0].pid);const u=$('[component="topic"]>[component="post"]:not([data-index=0]), [component="topic"]>[component="topic/event"]');P(t,u,e,!1,function(x){x&&x.addClass("new"),p(t.posts[0])})}function p(t){t.selfPost&&ajaxify.data.scrollToMyPost&&h.scrollBottom(t.index)}function P(t,e,f,u,x){if(x=x||function(){},!t||t.posts&&!t.posts.length)return x();function R(){const C=$('[component="post"].new');if(C.length===t.posts.length){let S=!0;if(C.each(function(I,L){parseInt($(L).attr("data-pid"),10)!==parseInt(t.posts[I].pid,10)&&(S=!1)}),S){C.each(function(){$(this).removeClass("new")}),t.posts.length=0;return}}C.length&&t.posts.length>1&&t.posts.forEach(function(S){const I=g.get("post","pid",S.pid);I.hasClass("new")&&I.remove()}),t.posts=t.posts.filter(function(S){return S.allowDupe||$('[component="post"][data-pid="'+S.pid+'"]').length===0})}if(R(),!t.posts.length)return x();let T,B;f>0&&e.length?T=e.last():f<0&&e.length&&(B=e.first()),E.fire("action:posts.loading",{posts:t.posts,after:T,before:B}),app.parseAndTranslate("topic","posts",Object.assign({},ajaxify.data,t),async function(C){C=C.filter(function(){const I=$(this),L=I.attr("data-pid"),F=I.attr("data-allow-dupe");return!I.is('[component="post"]')||F||L&&$('[component="post"][data-pid="'+L+'"]').length===0});const S=m.removeExtra($('[component="post"]'),f,Math.max(20,config.postsPerPage*2));if(T)C.insertAfter(T);else if(B){const I=$(document).height(),L=c.scrollTop();C.insertBefore(B),(u||L>0)&&c.scrollTop(L+($(document).height()-I))}else g.get("topic").append(C);await a.onNewPostsAddedToDom(C),O(S),E.fire("action:posts.loaded",{posts:t.posts}),x(C)})}a.loadMorePosts=function(t){if(!g.get("topic").length||h.scrollActive)return;const e=g.get("topic").find(g.get("post").not("[data-index=0]").not(".new")),f=t>0?e.last():e.first(),u=parseInt(f.attr("data-index"),10)||0,x=ajaxify.data.tid;if(!utils.isNumber(x)||!utils.isNumber(u)||t<0&&g.get("post","index",0).length)return;const R=$(".loading-indicator");R.is(":animated")||R.fadeIn(),m.loadMore("topics.loadMore",{tid:x,after:u+(t>0?1:0),count:config.postsPerPage,direction:t,topicPostSort:utils.params().sort||config.topicPostSort},function(T,B){if(R.fadeOut(),T&&T.posts&&T.posts.length){const C=$('[component="post"]:not([data-index=0]):not(.new), [component="topic/event"]');P(T,C,t,!0,B)}else h.update(),B()})},a.onTopicPageLoad=async function(t){U(t),k.wrapImagesInLinks(t),W(t),a.showBottomPostBar(),t.find('[component="post/content"] img:not(.not-responsive)').addClass("img-fluid"),a.addBlockquoteEllipses(t),K(t),await j()},a.addTopicEvents=async function(t){if(config.topicPostSort==="most_votes")return;const e=await Promise.all(t.map(f=>app.parseAndTranslate("partials/topic/event",{...f,privileges:ajaxify.data.privileges})));if(config.topicPostSort==="oldest_to_newest")$('[component="topic"]').append(e);else if(config.topicPostSort==="newest_to_oldest"){const f=$('[component="topic"] [component="post"][data-index="0"]');f.length?f.after(e.reverse()):$('[component="topic"]').prepend(e.reverse())}$('[component="topic/event"] .timeago').timeago()};async function j(){const t=ajaxify.data.necroThreshold*24*60*60*1e3;if(!t||config.topicPostSort!=="newest_to_oldest"&&config.topicPostSort!=="oldest_to_newest")return;const e=c.scrollTop(),f=$('[component="post"]').toArray();await Promise.all(f.map(async function(u){u=$(u);const x=u.prev('[component="post"]');if(u.is(":has(.necro-post)")||!x.length||config.topicPostSort==="newest_to_oldest"&&parseInt(x.attr("data-index"),10)===0)return;const R=u.attr("data-timestamp")-x.attr("data-timestamp");if(Math.abs(R)>=t){const T=["suffixAgo","prefixAgo","suffixFromNow","prefixFromNow"],B={};T.forEach(I=>{B[I]=$.timeago.settings.strings[I],$.timeago.settings.strings[I]=""});const C=(R>0?"[[topic:timeago-later,":"[[topic:timeago-earlier,")+$.timeago.inWords(R)+"]]";T.forEach(I=>{$.timeago.settings.strings[I]=B[I]});const S=await app.parseAndTranslate("partials/topic/necro-post",{text:C});S.attr("data-necro-post-index",x.attr("data-index")),S.insertBefore(u)}})),e>0&&c.scrollTop()<e&&c.scrollTop(e)}function W(t){ajaxify.data["signatures:hideDuplicates"]&&t.each((e,f)=>{const u=$(f).find('[component="post/signature"]'),x=u.attr("data-uid");a.signaturesShown[x]?u.addClass("hidden"):a.signaturesShown[x]=!0})}function O(t){t.each((e,f)=>{$(`[data-necro-post-index="${$(f).attr("data-index")}"]`).remove()})}function U(t){if(app.user.uid||!ajaxify.data.privateUploads)return;const e=document.createElement("a");e.className="login-required",e.href=config.relative_path+"/login",M.translate("[[topic:login-to-view]]",function(f){e.appendChild(document.createTextNode(f)),t.each(function(u,x){$(x).find('[component="post/content"] img').each(function(R,T){T=$(T),T.attr("src").startsWith(config.relative_path+config.upload_url)&&T.replaceWith(e.cloneNode(!0))})})})}a.onNewPostsAddedToDom=async function(t){await a.onTopicPageLoad(t),t.find(".timeago").timeago()},a.showBottomPostBar=function(){const t=g.get("post","index",0),e=$(".post-bar-placeholder"),f=$('[component="post"]');t.length&&f.length>1&&$(".post-bar").length<2&&e.length?($(".post-bar").clone().insertAfter(e),e.remove()):t.length&&f.length<2&&t.find(".post-bar").remove()};function K(t){t.each(function(){$(this).hasClass("deleted")&&v.toggle($(this).attr("data-pid"),!0)})}return a.addBlockquoteEllipses=function(t){t.find('[component="post/content"] blockquote').filter((u,x)=>!$(x).parent().is("blockquote")).find(">blockquote").each(function(){const u=$(this);u.find(":hidden:not(br)").length&&!u.find(".toggle").length&&u.append('<i class="d-inline-block fa fa-angle-down pointer toggle py-1 px-3 border text-bg-light"></i>')})},a}.apply(b,D),A!==void 0&&(N.exports=A)},60392:(N,b,i)=>{var D,A;D=[i(7237),i(32230),i(66044),i(60447),i(74344),i(85233),i(63281),i(7927),i(73138)],A=function(d,m,v,k,h,g,M,E,w){const a={};a.init=function(o,n){c(n),$(".topic-main-buttons [title]").tooltip({container:"#content",animation:!1}),a.observeTopicLabels($('[component="topic/labels"]')),n.on("click",'[component="topic/delete"]',function(){return r("del","/state","delete"),!1}),n.on("click",'[component="topic/restore"]',function(){return r("put","/state","restore"),!1}),n.on("click",'[component="topic/purge"]',function(){return r("del","","purge"),!1}),n.on("click",'[component="topic/lock"]',function(){return r("put","/lock","lock"),!1}),n.on("click",'[component="topic/unlock"]',function(){return r("del","/lock","unlock"),!1}),n.on("click",'[component="topic/pin"]',function(){return r("put","/pin","pin"),!1}),n.on("click",'[component="topic/unpin"]',function(){return r("del","/pin","unpin"),!1}),n.on("click",'[component="topic/mark-unread"]',function(){r("del","/read",void 0,()=>{app.previousUrl&&!app.previousUrl.match("^/topic")?ajaxify.go(app.previousUrl,function(){v.onBackClicked(!0)}):ajaxify.data.category&&ajaxify.go("category/"+ajaxify.data.category.slug,v.onBackClicked),E.success("[[topic:mark-unread.success]]")})}),n.on("click",'[component="topic/mark-unread-for-all"]',function(){const s=$(this);r("put","/bump",void 0,()=>{E.success("[[topic:markAsUnreadForAll.success]]"),s.parents(".thread-tools.open").find(".dropdown-toggle").trigger("click")})}),n.on("click",'[component="topic/event/delete"]',function(){const s=$(this).attr("data-topic-event-id"),p=$(this).parents('[component="topic/event"]');M.confirm("[[topic:delete-event-confirm]]",P=>{P&&h.del(`/topics/${o}/events/${s}`,{}).then(function(){p.remove()}).catch(E.error)})}),n.on("click",'[component="topic/move"]',function(){return i.e(17434).then(function(){var s=[i(57378)];(function(p){p.init([o],ajaxify.data.cid)}).apply(null,s)}).catch(i.oe),!1}),n.on("click",'[component="topic/delete/posts"]',function(){i.e(55253).then(function(){var s=[i(55253)];(function(p){p.init()}).apply(null,s)}).catch(i.oe)}),n.on("click",'[component="topic/fork"]',function(){i.e(20670).then(function(){var s=[i(25636)];(function(p){p.init()}).apply(null,s)}).catch(i.oe)}),n.on("click",'[component="topic/merge"]',function(){i.e(90028).then(function(){var s=[i(90028)];(function(p){p.init(function(){p.addTopic(ajaxify.data.tid)})}).apply(null,s)}).catch(i.oe)}),n.on("click",'[component="topic/tag"]',function(){i.e(62516).then(function(){var s=[i(62516)];(function(p){p.init([ajaxify.data],ajaxify.data.tagWhitelist)}).apply(null,s)}).catch(i.oe)}),n.on("click",'[component="topic/move-posts"]',function(){i.e(53094).then(function(){var s=[i(53094)];(function(p){p.init()}).apply(null,s)}).catch(i.oe)}),n.on("click",'[component="topic/following"]',function(){l("follow")}),n.on("click",'[component="topic/not-following"]',function(){l("follow",0)}),n.on("click",'[component="topic/ignoring"]',function(){l("ignore")});function l(s,p=1){return h[p?"put":"del"](`/topics/${o}/${s}`,{},()=>{let j="";s==="follow"?j=p?"[[topic:following-topic.message]]":"[[topic:not-following-topic.message]]":s==="ignore"&&(j=p?"[[topic:ignoring-topic.message]]":"[[topic:not-following-topic.message]]"),p||(s="unfollow"),y(s),E.alert({alert_id:"follow_thread",message:j,type:"success",timeout:5e3}),g.fire("action:topics.changeWatching",{tid:o,type:s})},()=>{E.alert({type:"danger",alert_id:"topic_follow",title:"[[global:please-log-in]]",message:"[[topic:login-to-subscribe]]",timeout:5e3})}),!1}},a.observeTopicLabels=function(o){const n=new MutationObserver(function(l){const s=l[0];if(s&&s.attributeName==="class"){const p=o.children().filter((P,j)=>!$(j).hasClass("hidden"));o.toggleClass("hidden",!p.length)}});o.children().each((l,s)=>{n.observe(s,{attributes:!0})})};function c(o){o&&o.on("show.bs.dropdown",".thread-tools",async function(){const n=$(this),l=n.find(".dropdown-menu"),{top:s}=this.getBoundingClientRect();if(n.toggleClass("dropup",s>window.innerHeight/2),l.attr("data-loaded"))return;const p=await socket.emit("topics.loadTopicTools",{tid:ajaxify.data.tid,cid:ajaxify.data.cid}),P=await app.parseAndTranslate("partials/topic/topic-menu-list",p);$(l).attr("data-loaded","true").html(P),g.fire("action:topic.tools.load",{element:$(l)})})}function r(o,n,l,s){s||(s=function(){});const p=ajaxify.data.tid,P={},j=function(W){W&&h[o](`/topics/${p}${n}`,P).then(s).catch(E.error)};switch(l){case"delete":case"restore":case"purge":M.confirm(`[[topic:thread-tools.${l}-confirm]]`,j);break;case"pin":a.requestPinExpiry(P,j.bind(null,!0));break;default:j(!0);break}}a.requestPinExpiry=function(o,n){app.parseAndTranslate("modals/set-pin-expiry",{},function(l){const s=M.dialog({title:"[[topic:thread-tools.pin]]",message:l,onEscape:!0,size:"small",buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[global:save]]",className:"btn-primary",callback:function(){let P=s.get(0).querySelector("#expiry").value;if(P==="")return n();P=new Date(P),P&&P.getTime()>Date.now()?(o.expiry=P.getTime(),n()):E.error("[[error:invalid-date]]")}}}})})},a.setLockedState=function(o){const n=d.get("topic");if(parseInt(o.tid,10)!==parseInt(n.attr("data-tid"),10))return;const l=o.isLocked&&!ajaxify.data.privileges.isAdminOrMod;d.get("topic/lock").toggleClass("hidden",o.isLocked).parent().attr("hidden",o.isLocked?"":null),d.get("topic/unlock").toggleClass("hidden",!o.isLocked).parent().attr("hidden",o.isLocked?null:"");const s=!!((o.isLocked||ajaxify.data.deleted)&&!ajaxify.data.privileges.isAdminOrMod);d.get("topic/reply/container").toggleClass("hidden",s),d.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!o.isLocked||ajaxify.data.deleted),n.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",s),n.find('[component="post/edit"], [component="post/delete"]').toggleClass("hidden",l),n.find('[component="post"][data-uid="'+app.user.uid+'"].deleted [component="post/tools"]').toggleClass("hidden",l),$('[component="topic/labels"] [component="topic/locked"]').toggleClass("hidden",!o.isLocked),$('[component="post/tools"] .dropdown-menu').html(""),ajaxify.data.locked=o.isLocked,k.addTopicEvents(o.events)},a.setDeleteState=function(o){const n=d.get("topic");if(parseInt(o.tid,10)!==parseInt(n.attr("data-tid"),10))return;d.get("topic/delete").toggleClass("hidden",o.isDelete).parent().attr("hidden",o.isDelete?"":null),d.get("topic/restore").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),d.get("topic/purge").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),d.get("topic/deleted/message").toggleClass("hidden",!o.isDelete),o.isDelete&&app.parseAndTranslate("partials/topic/deleted-message",{deleter:o.user,deleted:!0,deletedTimestampISO:utils.toISOString(Date.now())},function(s){d.get("topic/deleted/message").replaceWith(s),s.find(".timeago").timeago()});const l=o.isDelete&&!ajaxify.data.privileges.isAdminOrMod;d.get("topic/reply/container").toggleClass("hidden",l),d.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!ajaxify.data.locked||o.isDelete),n.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",l),n.toggleClass("deleted",o.isDelete),ajaxify.data.deleted=o.isDelete?1:0,k.addTopicEvents(o.events)},a.setPinnedState=function(o){const n=d.get("topic");if(parseInt(o.tid,10)!==parseInt(n.attr("data-tid"),10))return;d.get("topic/pin").toggleClass("hidden",o.pinned).parent().attr("hidden",o.pinned?"":null),d.get("topic/unpin").toggleClass("hidden",!o.pinned).parent().attr("hidden",o.pinned?null:"");const l=$('[component="topic/labels"] [component="topic/pinned"]');l.toggleClass("hidden",!o.pinned),o.pinned&&l.translateAttr("title",o.pinExpiry&&o.pinExpiryISO?"[[topic:pinned-with-expiry, "+o.pinExpiryISO+"]]":"[[topic:pinned]]"),ajaxify.data.pinned=o.pinned,k.addTopicEvents(o.events)};function y(o){const n={follow:"[[topic:watching]]",unfollow:"[[topic:not-watching]]",ignore:"[[topic:ignoring]]"};m.translate(n[o],function(s){const p=w.Tooltip.getInstance('[component="topic/watch"]');p&&p.setContent({".tooltip-inner":s})});let l=d.get("topic/following/menu");l.toggleClass("hidden",o!=="follow"),d.get("topic/following/check").toggleClass("fa-check",o==="follow"),l=d.get("topic/not-following/menu"),l.toggleClass("hidden",o!=="unfollow"),d.get("topic/not-following/check").toggleClass("fa-check",o==="unfollow"),l=d.get("topic/ignoring/menu"),l.toggleClass("hidden",o!=="ignore"),d.get("topic/ignoring/check").toggleClass("fa-check",o==="ignore")}return a}.apply(b,D),A!==void 0&&(N.exports=A)},66044:(N,b,i)=>{var D,A;D=[i(7237),i(66603),i(42840),i(78989)],A=function(d,m,v,k){const h={};let g;h.init=function(w){g=w,M(),$(window).off("action:popstate",E).on("action:popstate",E)},h.onBackClicked=E;function M(){$('[component="category"]').on("click",'[component="topic/header"]',function(){const w=$(this).parents("[data-index]").attr("data-index"),a=$(window).scrollTop();$('[component="category/topic"]').each(function(c,r){if($(r).offset().top-a>0)return m.setItem("category:bookmark",$(r).attr("data-index")),m.setItem("category:bookmark:clicked",w),m.setItem("category:bookmark:offset",$(r).offset().top-a),!1})})}function E(w){const a=w&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||a){let c=m.getItem("category:bookmark"),r=m.getItem("category:bookmark:clicked");if(m.removeItem("category:bookmark"),m.removeItem("category:bookmark:clicked"),!utils.isNumber(c))return;if(c=Math.max(0,parseInt(c,10)||0),r=Math.max(0,parseInt(r,10)||0),config.usePagination){const y=Math.ceil((parseInt(c,10)+1)/config.topicsPerPage);parseInt(y,10)!==ajaxify.data.pagination.currentPage?k.loadPage(y,function(){h.scrollToTopic(c,r)}):h.scrollToTopic(c,r)}else{if(c===0){h.scrollToTopic(c,r);return}$('[component="category"]').empty(),g(Math.max(0,c-1)+1,function(){h.scrollToTopic(c,r)})}}}return h.highlightTopic=function(w){const a=d.get("category/topic","index",w);a.length&&!a.hasClass("highlight")&&(a.addClass("highlight"),setTimeout(function(){a.removeClass("highlight")},5e3))},h.scrollToTopic=function(w,a){if(!utils.isNumber(w))return;const c=d.get("category/topic","index",w);if(c.length){const r=m.getItem("category:bookmark:offset");m.removeItem("category:bookmark:offset"),$(window).scrollTop(c.offset().top-r),h.highlightTopic(a),v.update()}},h}.apply(b,D),A!==void 0&&(N.exports=A)}}]);
