"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[49397,70565,84745,83014,99617],{98900:(v,p,s)=>{var d,l;d=[s(7237),s(74344),s(7927),s(85925)],l=function(h,A,f,c){const i={};i.init=function(){h.get("chat/create").on("click",m)};async function m(){let g=[];app.user.isAdmin&&(g=await socket.emit("groups.getChatGroups",{}));const y=await app.parseAndTranslate("modals/create-room",{user:app.user,groups:g}),o=bootbox.dialog({title:"[[modules:chat.create-room]]",message:y,onEscape:!0,buttons:{save:{label:"[[global:create]]",className:"btn-primary",callback:function(){const a=o.find('[component="chat/room/name"]').val(),e=o.find('[component="chat/room/users"] [component="chat/user"]').find("[data-uid]").map((E,C)=>$(C).attr("data-uid")).get(),n=o.find('[component="chat/room/type"]').val(),t=o.find('[component="chat/room/groups"]').val();return n==="private"&&!e.length?(f.error("[[error:no-users-selected]]"),!1):n==="public"&&!t.length?(f.error("[[error:no-groups-selected]]"),!1):app.user.uid?(A.post("/chats",{roomName:a,uids:e,type:n,groups:t}).then(({roomId:E})=>{ajaxify.go("chats/"+E),o.modal("hide")}).catch(f.error),!1):(f.error("[[error:not-logged-in]]"),!1)}}}}),r=o.find('[component="chat/room/users"]');c.init({onSelect:async function(a){const e=await app.parseAndTranslate("modals/create-room","selectedUsers",{selectedUsers:[a]});r.append(e)}}),r.on("click",'[component="chat/room/users/remove"]',function(){$(this).parents("[data-uid]").remove()}),o.find('[component="chat/room/type"]').on("change",function(){const a=$(this).val();o.find('[component="chat/room/public/options"]').toggleClass("hidden",a==="private")})}return i}.apply(p,d),l!==void 0&&(v.exports=l)},85925:(v,p,s)=>{var d,l;d=[s(7237),s(74344),s(7927)],l=function(h,A,f){const c={};let i=[];c.init=function(r){r=r||{},i.length=0,h.get("chat/search").on("keyup",utils.debounce(g,250));const a=$('[component="chat/search/list"]');a.on("click","[data-uid]",function(){r.onSelect&&r.onSelect(i.find(e=>parseInt(e.uid,10)===parseInt($(this).attr("data-uid"),10))),m(a)})};function m(r){h.get("chat/search").val(""),y(r),r.find('[component="chat/search/no-users"]').addClass("hidden"),r.find('[component="chat/search/start-typing"]').removeClass("hidden")}function g(){const r=$('[component="chat/search/list"]'),a=h.get("chat/search").val();if(!a)return m(r);r.find('[component="chat/search/start-typing"]').addClass("hidden"),A.get("/api/users",{query:a,searchBy:"username",paginate:!1}).then(o).catch(f.error)}function y(r){i.length=0,r.find("[data-uid]").remove()}async function o(r){const a=$('[component="chat/search/list"]');if(y(a),r.users=r.users.filter(function(n){return parseInt(n.uid,10)!==parseInt(app.user.uid,10)}),i=r.users,!r.users.length)return a.find('[component="chat/search/no-users"]').removeClass("hidden");a.find('[component="chat/search/no-users"]').addClass("hidden");const e=await app.parseAndTranslate("modals/create-room","searchUsers",{searchUsers:r.users});a.append(e),a.parent().toggleClass("show",!0)}return c}.apply(p,d),l!==void 0&&(v.exports=l)},74344:(v,p,s)=>{s.r(p),s.d(p,{del:()=>a,get:()=>m,head:()=>g,patch:()=>o,post:()=>y,put:()=>r});var d=s(85233),l=s.n(d),h=s(63281),A=s.n(h);const f=config.relative_path+"/api/v3";async function c(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:f+e.url,typeof n=="function"){i(e).then(t=>n(null,t),t=>n(t));return}try{return await i(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again.")return(0,h.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go("login")});throw t}}async function i(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,d.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:E}=t,C=E.get("content-type"),D=C&&C.startsWith("application/json");let u;if(e.method!=="head"&&(D?u=await t.json():u=await t.text()),!t.ok)throw u?new Error(D?u.status.message:u):new Error(t.statusText);return D&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function m(e,n,t){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function g(e,n,t){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},t)}function y(e,n,t){return c({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function o(e,n,t){return c({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function r(e,n,t){return c({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function a(e,n,t){return c({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}}}]);
