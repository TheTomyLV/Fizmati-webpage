"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[48724],{50395:(g,f,r)=>{var i,c;i=[r(7237),r(85233)],c=function(s,C){const h={};h.prepareDOM=function(){const t=$('[component="chat/dropdown"]');t.length&&(t.on("show.bs.dropdown",n=>{o("loadChatsDropdown",$(n.target).parent().find('[component="chat/list"]'))}),t.each((n,e)=>{const a=$(e).parent().find(".dropdown-menu");a.hasClass("show")&&o("loadChatsDropdown",a.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",d),socket.on("event:chats.receive",d),socket.removeListener("event:chats.typing",u),socket.on("event:chats.typing",u),socket.removeListener("event:chats.roomRename",p),socket.on("event:chats.roomRename",p),socket.on("event:unread.updateChatCount",async function(n){if(n){const[m,v]=await app.require(["chat","forum/chats"]);if(m.isFromBlockedUser(n.fromUid)||m.isLookingAtRoom(n.roomId)||app.user.uid===parseInt(n.fromUid,10))return;v.markChatPageElUnread(n)}let e=await socket.emit("modules.chats.getUnreadCount",{});const a=s.get("chat/icon");e=Math.max(0,e),a.toggleClass("fa-comment",e>0).toggleClass("fa-comment-o",e<=0);const l=e>99?"99+":e;s.get("chat/icon").toggleClass("unread-count",e>0).attr("data-content",l),s.get("chat/count").toggleClass("hidden",e<=0).text(l),C.fire("action:chat.updateCount",{count:e})}))};function d(t){o("onChatMessageReceived",t)}function u(t){o("onUserTyping",t)}function p(t){o("onRoomRename",t)}async function o(t,n){(await app.require("chat"))[t](n)}return h}.apply(f,i),c!==void 0&&(g.exports=c)}}]);
