"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[27424,70565,9126,83014,99617,10999],{85803:(x,C,i)=>{var h,p;h=[i(85233),i(32230),i(86569)],p=function(d,m){const l={_capsState:!1};return l.init=function(){const o=$("#login-error-notify"),u=$("#login"),g=$("#login-form");u.on("click",async function(f){f.preventDefault();const v=$("#username").val(),y=$("#password").val();if(!v||!y)o.find("p").translateText("[[error:invalid-username-or-password]]"),o.show();else{if(o.hide(),u.hasClass("disabled"))return;u.addClass("disabled");try{if((await d.fire("filter:app.login",{username:v,password:y,cancel:!1})).cancel){u.removeClass("disabled");return}}catch(c){o.find("p").translateText(c.message),o.show(),u.removeClass("disabled");return}d.fire("action:app.login"),g.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(c){d.fire("action:app.loggedIn",c);const w=utils.urlToLocation(c.next).pathname,e=utils.params({url:c.next});e.loggedin=!0,delete e.register;const n=decodeURIComponent($.param(e));window.location.href=w+"?"+n},error:function(c){let w=c.responseText;const e=c.responseJSON;c.status===403&&c.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":e&&e.hasOwnProperty("banned_until")&&(w=e.banned_until?m.compile("error:user-banned-reason-until",new Date(e.banned_until).toLocaleString(),e.reason):"[[error:user-banned-reason, "+e.reason+"]]"),o.find("p").translateText(w),o.show(),u.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),l.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#login-error-notify button").on("click",function(f){return f.preventDefault(),o.hide(),!1}),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},l.capsLockCheck=(o,u)=>{const g=f=>{u.classList[f?"remove":"add"]("hidden"),u.parentNode.classList[f?"add":"remove"]("has-warning")};o&&(o.addEventListener("keyup",function(f){if(l._capsState&&f.key==="CapsLock"){g(!1),l._capsState=!l._capsState;return}l._capsState=f.getModifierState&&f.getModifierState("CapsLock"),g(l._capsState)}),l._capsState&&g(!0))},l}.apply(C,h),p!==void 0&&(x.exports=p)},70935:(x,C,i)=>{var h,p;h=[i(32230),i(22568),i(74344),i(63281),i(85803),i(21322),i(86569)],p=function(d,m,l,o,u,g){const f={};let v=!1;const y="";f.init=function(){const s=$("#username"),a=$("#password"),t=$("#password-confirm"),E=$("#register");D(),$("#content #noscript").val("false");const L=utils.params();L.token&&$("#token").val(L.token),s.on("keyup",function(){$("#yourUsername").text(this.value.length>0?m(this.value):"username")}),s.on("blur",function(){s.val().length&&c(s.val())}),a.on("blur",function(){a.val().length&&w(a.val(),t.val())}),t.on("blur",function(){t.val().length&&e(a.val(),t.val())});function k(P){v=!1,w(a.val(),t.val()),e(a.val(),t.val()),c(s.val(),P)}u.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),E.on("click",function(P){const A=$(this),b=$("#register-error-notify");b.addClass("hidden"),P.preventDefault(),k(function(){v||(A.addClass("disabled"),A.parents("form").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},success:function(_){if(A.removeClass("disabled"),!!_)if(_.next){const S=utils.urlToLocation(_.next).pathname,T=utils.params({url:_.next});T.registered=!0;const O=decodeURIComponent($.param(T));window.location.href=S+"?"+O}else _.message&&d.translate(_.message,function(S){o.alert(S),ajaxify.go("/")})},error:function(_){d.translate(_.responseText,config.defaultLang,function(S){_.status===403&&_.responseText==="Forbidden"?window.location.href=config.relative_path+"/register?error=csrf-invalid":(b.find("p").text(S),b.removeClass("hidden"),A.removeClass("disabled"))})}}))})}),$("#username").focus()};function c(s,a){a=a||function(){};const t=$("#username-notify"),E=m(s);s.length<ajaxify.data.minimumUsernameLength||E.length<ajaxify.data.minimumUsernameLength?n(t,"[[error:username-too-short]]"):s.length>ajaxify.data.maximumUsernameLength?n(t,"[[error:username-too-long]]"):!utils.isUserNameValid(s)||!E?n(t,"[[error:invalid-username]]"):Promise.allSettled([l.head(`/users/bySlug/${E}`,{}),l.head(`/groups/${s}`,{})]).then(L=>{L.every(k=>k.status==="rejected")?r(t,y):n(t,"[[error:username-taken]]"),a()})}function w(s,a){const t=$("#password-notify"),E=$("#password-confirm-notify");try{if(utils.assertPasswordValidity(s,g),s===$("#username").val())throw new Error("[[user:password-same-as-username]]");r(t,y)}catch(L){n(t,L.message)}s!==a&&a!==""&&n(E,"[[user:change-password-error-match]]")}function e(s,a){const t=$("#password-notify"),E=$("#password-confirm-notify");!s||t.hasClass("alert-error")||(s!==a?n(E,"[[user:change-password-error-match]]"):r(E,y))}function n(s,a){d.translate(a,function(t){s.html(t),s.parent().removeClass("register-success").addClass("register-danger"),s.show()}),v=!0}function r(s,a){d.translate(a,function(t){s.html(t),s.parent().removeClass("register-danger").addClass("register-success"),s.show()})}function D(){if(!app.user.uid&&config.defaultLang!==config.userLang){const s=$('[component="register/local"]'),a=$('<input type="hidden" name="userLang" value="'+config.userLang+'" />');s.append(a)}}return f}.apply(C,h),p!==void 0&&(x.exports=p)},74344:(x,C,i)=>{i.r(C),i.d(C,{del:()=>w,get:()=>g,head:()=>f,patch:()=>y,post:()=>v,put:()=>c});var h=i(85233),p=i.n(h),d=i(63281),m=i.n(d);const l=config.relative_path+"/api/v3";async function o(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:l+e.url,typeof n=="function"){u(e).then(r=>n(null,r),r=>n(r));return}try{return await u(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again.")return(0,d.confirm)("[[error:api.reauth-required]]",D=>{D&&ajaxify.go("login")});throw r}}async function u(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const r=await fetch(n,e),{headers:D}=r,s=D.get("content-type"),a=s&&s.startsWith("application/json");let t;if(e.method!=="head"&&(a?t=await r.json():t=await r.text()),!r.ok)throw t?new Error(a?t.status.message:t):new Error(r.statusText);return a&&t&&t.hasOwnProperty("status")&&t.hasOwnProperty("response")?t.response:t}function g(e,n,r){return o({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},r)}function f(e,n,r){return o({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},r)}function v(e,n,r){return o({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},r)}function y(e,n,r){return o({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},r)}function c(e,n,r){return o({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},r)}function w(e,n,r){return o({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},r)}},22568:(x,C,i)=>{var h,p,d;(function(m){p=[i(20648)],h=m,d=typeof h=="function"?h.apply(C,p):h,d!==void 0&&(x.exports=d)})(function(m){const l=m("[^\\p{L}\\s\\d\\-_]","g"),o=/[^\w\s\d\-_]/g,u=/^\s+|\s+$/g,g=/\s+/g,f=/-+/g,v=/-$/g,y=/^-/g,c=/^[\w\d\s.,\-@]+$/;return function(e,n){return e?(e=String(e).replace(u,""),c.test(e)?e=e.replace(o,"-"):e=m.replace(e,l,"-"),e=n?e:e.toLocaleLowerCase(),e=e.replace(g,"-"),e=e.replace(f,"-"),e=e.replace(v,""),e=e.replace(y,""),e):""}})}}]);
