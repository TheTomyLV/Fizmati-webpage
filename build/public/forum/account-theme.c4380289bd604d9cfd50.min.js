(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[31480,38786,25655,28306],{5750:(E,v,l)=>{E.exports=l(96919)},18340:(E,v,l)=>{"use strict";var A,u;A=[l(85233),l(7927)],u=function(p,c){let s,m=[],y=0,a;function S(e,t){typeof e!="string"&&(e=$(e),e=e.data("type")||e.attr("type")||e.prop("tagName"));const i=s.plugins[e.toLowerCase()];if(i==null)return;const n=i[t];return typeof n=="function"?n:null}return a={deepClone:function(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,i){const n=document.createElement(e);for(const r in t)t.hasOwnProperty(r)&&n.setAttribute(r,t[r]);return i&&n.appendChild(document.createTextNode(i)),n},initElement:function(e){const t=S(e,"init");t?.call(s,$(e))},destructElement:function(e){const t=S(e,"destruct");t?.call(s,$(e))},createElementOfType:function(e,t,i){let n;const r=S(e,"create");return r!=null?n=$(r.call(s,e,t,i)):(i==null&&(i={}),e!=null&&(i.type=e),n=$(a.createElement(t||"input",i))),n.data("type",e),a.initElement(n),n},cleanArray:function(e,t,i){const n=[];if(!t&&i)return e;for(let r=0;r<e.length;r+=1){let o=e[r];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(i||o!=null&&o.length)&&n.push(o)}return n},isTrue:function(e){return e==="true"||+e==1},isFalse:function(e){return e==="false"||+e==0},readValue:function(e){let t=!a.isFalse(e.data("empty"));const i=!a.isFalse(e.data("trim")),n=e.data("split"),r=S(e,"get");let o;if(r!=null)return r.call(s,e,i,t);if(n!=null){t=a.isTrue(e.data("empty")),o=e.val();const g=o!=null&&o.split(n||",")||[];return a.cleanArray(g,i,t)}if(o=e.val(),i&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(e,t){const i=S(e,"set");let n=e.data("trim");if(n=n!=="false"&&+n!=0,i!=null)return i.call(s,e,t,n);t instanceof Array&&(t=t.join(e.data("split")||(n?", ":","))),n&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),n&&(t=t.trim())):t="",t!==void 0&&e.val(t)},initFields:function(e){$("[data-key]",e).each(function(t,i){i=$(i);const n=S(i,"init"),r=i.data("key").split(".");let o=s.get();n?.call(s,i);for(let g=0;g<r.length;g+=1){const f=r[g];f&&o!=null&&(o=o[f])}a.fillField(i,o)})},registerReadyJobs:function(e){return y+=e,y},beforeReadyJobsDecreased:function(e){if(e==null&&(e=1),y>0&&(y-=e,y<=0)){for(let t=0;t<m.length;t+=1)m[t]();m=[]}},whenReady:function(e){y<=0?e():m.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each(function(i,n){n=$(n),n.is(":checked")||(t[n.attr("name")]="off")}),e.find("select[multiple]").each(function(i,n){n=$(n),t[n.attr("name")]=JSON.stringify(n.val())}),t},persistSettings:function(e,t,i,n){t!=null&&t._!=null&&typeof t._!="string"&&(t=a.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:e,values:t},function(r){i&&(r?c.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${r.message}]]`,timeout:5e3}):c.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof n=="function"&&n(r)})},use:function(e){try{e._=JSON.parse(e._)}catch{}s.cfg=e}},s={helper:a,plugins:{},cfg:{},get:function(){return s.cfg!=null&&s.cfg._!==void 0?s.cfg._:s.cfg},registerPlugin:function(e,t){t==null?t=e.types:e.types=t,typeof e.use=="function"&&e.use.call(s);for(let i=0;i<t.length;i+=1){const n=t[i].toLowerCase();s.plugins[n]==null&&(s.plugins[n]=e)}},set:function(e,t,i,n,r){r==null&&(r=!0),a.whenReady(function(){a.use(t),a.initFields(i||"form"),a.persistSettings(e,t,r,n)})},sync:function(e,t,i){socket.emit("admin.settings.get",{hash:e},function(n,r){n?typeof i=="function"&&i(n):a.whenReady(function(){a.use(r),a.initFields(t||"form"),typeof i=="function"&&i()})})},persist:function(e,t,i,n){const r=[],o=$("[data-key]",t||"form").toArray();n==null&&(n=!0);for(let g=0;g<o.length;g+=1){const f=$(o[g]),h=a.readValue(f);let d=s.get();const I=f.data("key").split("."),x=I[I.length-1];if(I.length>1)for(let R=0;R<I.length-1;R+=1){const F=I[R];F&&d!=null&&(d=d[F])}d!=null?h!=null?d[x]=h:delete d[x]:r.push(f.data("key"))}r.length&&c.alert({title:"Attributes Not Saved",message:"'"+r.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),a.persistSettings(e,s.cfg,n,i)},load:function(e,t,i){i=i||function(){};const n=t.attr("data-socket-get");socket.emit(n||"admin.settings.get",{hash:e},function(r,o){if(r)return i(r);$(t).find("select[multiple]").each(function(f,h){const d=$(h).attr("name");if(d&&o.hasOwnProperty(d))try{o[d]=JSON.parse(o[d])}catch{}}),ajaxify.data[n?e:"settings"]=o,a.whenReady(function(){$(t).find("[data-sorted-list]").each(function(f,h){S(h,"get").call(s,$(h),e)})}),$(t).deserialize(o),p.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const g=document.getElementById("save");g&&l.e(42441).then(function(){var f=[l(42441)];(function(h){h.bind("ctrl+s",function(d){g.click(),d.preventDefault()})}).apply(null,f)}).catch(l.oe),i(null,o)})},save:function(e,t,i){t=$(t);const n=t.get(0).elements;if(s.check(n)&&t.length){const o=a.serializeForm(t);a.whenReady(function(){const f=t.find("[data-sorted-list]");f.length&&f.each((h,d)=>{S(d,"set").call(s,$(d),o)})});const g=t.attr("data-socket-set");socket.emit(g||"admin.settings.set",{hash:e,values:o},function(f){if(app.flags._unsaved=!1,ajaxify.data[g?e:"settings"]=o,typeof i=="function")i(f);else if(f)c.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${f.message}]]`,type:"error",timeout:2500});else{const h=document.getElementById("save");h.classList.toggle("saved",!0),setTimeout(()=>{h.classList.toggle("saved",!1)},1500)}})}},check:function(e){const t=i=>{const n=i.target.closest(".form-group");n&&n.classList.add("has-error"),i.target.removeEventListener("invalid",t)};return Array.prototype.map.call(e,i=>{const n=i.closest(".form-group");return n&&n.classList.remove("has-error"),i.addEventListener("invalid",t),i.reportValidity()}).every(Boolean)}},a.registerReadyJobs(1),Promise.all([l.e(66177),l.e(62526),l.e(26069)]).then(function(){var e=[l(16631),l(73143),l(7448),l(15101),l(846),l(88839),l(53411),l(66370)];(function(){for(let t=0;t<arguments.length;t+=1)s.registerPlugin(arguments[t]);a.beforeReadyJobsDecreased()}).apply(null,e)}).catch(l.oe),s}.apply(v,A),u!==void 0&&(E.exports=u)},66603:(E,v,l)=>{"use strict";var A;A=function(){function u(){this._store={},this._keys=[]}u.prototype.isMock=!0,u.prototype.setItem=function(s,m){s=String(s),this._keys.indexOf(s)===-1&&this._keys.push(s),this._store[s]=m},u.prototype.getItem=function(s){return s=String(s),this._keys.indexOf(s)===-1?null:this._store[s]},u.prototype.removeItem=function(s){s=String(s),this._keys=this._keys.filter(function(m){return m!==s}),this._store[s]=null},u.prototype.clear=function(){this._keys=[],this._store={}},u.prototype.key=function(s){return s=parseInt(s,10)||0,this._keys[s]},Object.defineProperty&&Object.defineProperty(u.prototype,"length",{get:function(){return this._keys.length}});let p;const c=Date.now().toString();try{if(p=window.localStorage,p.setItem(c,c),p.getItem(c)!==c)throw Error("localStorage behaved unexpectedly");return p.removeItem(c),p}catch(s){console.warn(s),console.warn("localStorage failed, falling back on sessionStorage");try{if(p=window.sessionStorage,p.setItem(c,c),p.getItem(c)!==c)throw Error("sessionStorage behaved unexpectedly");return p.removeItem(c),p}catch(m){return console.warn(m),console.warn("sessionStorage failed, falling back on memory storage"),new u}}}.call(v,l,v,E),A!==void 0&&(E.exports=A)},96919:(E,v,l)=>{"use strict";var A,u;A=[l(59494),l(66603),l(18340),l(7927)],u=function(p,c,s,m){const y={};return y.init=()=>{p.init(),y.setupForm()},y.setupForm=()=>{const a=document.getElementById("save"),S=document.getElementById("theme-settings"),[e,t]=[!!c.getItem("persona:menus:legacy-layout"),c.getItem("persona:navbar:autohide")];document.getElementById("persona:menus:legacy-layout").checked=e;try{(JSON.parse(t)||["xs","sm"]).forEach(n=>{const r=document.getElementById("persona:navbar:autohide").querySelector(`option[value="${n}"]`);r.selected=!0})}catch(i){console.warn(i)}a&&a.addEventListener("click",()=>{const i=s.helper.serializeForm($(S));Object.keys(i).forEach(n=>{if(n==="persona:menus:legacy-layout"){i[n]==="on"?c.setItem("persona:menus:legacy-layout","true"):c.removeItem("persona:menus:legacy-layout");return}c.setItem(n,i[n])}),m.success("[[success:settings-saved]]")})},y}.apply(v,A),u!==void 0&&(E.exports=u)}}]);
