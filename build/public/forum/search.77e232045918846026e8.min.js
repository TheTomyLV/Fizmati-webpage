"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4222,38786,70565,83014,52256,66623,99617,26721,10999,28306,26340],{68118:(F,S,u)=>{var C,m;C=[u(7073),u(66603),u(85233),u(7927),u(74344),u(32230),u(39941),u(36012)],m=function(y,v,f,h,g,r,l,o){const n={};let d=[],i=[],e=[],t={};n.init=function(){const c=$("#search-in");c.on("change",function(){T(c.val())});const p=$("#results").attr("data-search-query");y.highlightMatches(p,$(".search-results .content p, .search-results .topic-title")),$("#advanced-search form").off("submit").on("submit",function(s){return s.preventDefault(),y.query(w()),!1}),R(),_(ajaxify.data.selectedCids),k($('[component="user/filter"]'),ajaxify.data.userFilterSelected),B($('[component="tag/filter"]'),ajaxify.data.tagFilterSelected),$('[component="search/filters"]').on("hidden.bs.dropdown",".dropdown",function(){const s={replies:b,time:E,sort:x,tag:a};s[$(this).attr("data-filter-name")]&&s[$(this).attr("data-filter-name")]();const D=w();JSON.stringify(t)!==JSON.stringify(D)&&(t=D,y.query(t))}),O(),E(),b(),x(),t=w()};function a(){const c=i.length>0;let p="[[search:tags]]";i.length&&(p=r.compile("search:tags-x",i.map(s=>s.valueEscaped).join(", "))),$('[component="tag/filter/button"]').toggleClass("active-filter",c).find(".filter-label").translateText(p)}function E(){const c=$("#post-time-range").val()>0;$("#post-time-button").toggleClass("active-filter",c).find(".filter-label").translateText(c?`[[search:time-${$("#post-time-filter").val()}-than-${$("#post-time-range").val()}]]`:"[[search:time]]")}function x(){const c=$("#post-sort-by").val()!=="relevance"||$("#post-sort-direction").val()!=="desc";$("#sort-by-button").toggleClass("active-filter",c).find(".filter-label").translateText(c?`[[search:sort-by-${$("#post-sort-by").val()}-${$("#post-sort-direction").val()}]]`:"[[search:sort]]")}function b(){const c=$("#reply-count").val()>0;$("#reply-count-button").toggleClass("active-filter",c).find(".filter-label").translateText(c?`[[search:replies-${$("#reply-count-filter").val()}-count, ${$("#reply-count").val()}]]`:"[[search:replies]]")}function w(){const c=$("#advanced-search"),p={in:$("#search-in").val()};return p.term=$("#search-input").val(),(p.in==="posts"||p.in==="titlesposts"||p.in==="titles")&&(p.matchWords=c.find("#match-words-filter").val(),p.by=d.length?d.map(s=>s.username):void 0,p.categories=e.length?e:void 0,p.searchChildren=c.find("#search-children").is(":checked"),p.hasTags=i.length?i.map(s=>s.value):void 0,p.replies=c.find("#reply-count").val(),p.repliesFilter=c.find("#reply-count-filter").val(),p.timeFilter=c.find("#post-time-filter").val(),p.timeRange=c.find("#post-time-range").val(),p.sortBy=c.find("#post-sort-by").val(),p.sortDirection=c.find("#post-sort-direction").val(),p.showAs=c.find("#show-results-as").val()),f.fire("action:search.getSearchDataFromDOM",{form:c,data:p}),p}function T(c){const p=!c.includes("posts")&&!c.includes("titles");$(".post-search-item").toggleClass("hidden",p)}function O(){const c=utils.params({disableToType:!0}),p=y.getSearchPreferences(),s=utils.merge(p,c);s&&(ajaxify.data.term&&$("#search-input").val(ajaxify.data.term),s.in=s.in||ajaxify.data.searchDefaultIn,$("#search-in").val(s.in),T(s.in),s.matchWords&&$("#match-words-filter").val(s.matchWords),s.showAs&&$("#show-results-as").val(s.showAs),s.by&&(s.by=Array.isArray(s.by)?s.by:[s.by],s.by.forEach(function(D){$("#posted-by-user").tagsinput("add",D)})),s.categories&&$("#posted-in-categories").val(s.categories),s.searchChildren&&$("#search-children").prop("checked",!0),s.hasTags&&(s.hasTags=Array.isArray(s.hasTags)?s.hasTags:[s.hasTags],s.hasTags.forEach(function(D){$("#has-tags").tagsinput("add",D)})),s.replies&&($("#reply-count").val(s.replies),$("#reply-count-filter").val(s.repliesFilter)),s.timeRange&&($("#post-time-range").val(s.timeRange),$("#post-time-filter").val(s.timeFilter)),(s.sortBy||ajaxify.data.searchDefaultSortBy)&&$("#post-sort-by").val(s.sortBy||ajaxify.data.searchDefaultSortBy),$("#post-sort-direction").val(s.sortDirection||"desc"),f.fire("action:search.fillOutForm",{form:s}))}function R(){$("#save-preferences").on("click",function(){const c=w(),p=["matchWords","in","showAs","replies","repliesFilter","timeFilter","timeRange","sortBy","sortDirection"],s={};return p.forEach(D=>{s[D]=c[D]}),v.setItem("search-preferences",JSON.stringify(s)),h.success("[[search:search-preferences-saved]]"),!1}),$("#clear-preferences").on("click",async function(){v.removeItem("search-preferences");const c=await app.parseAndTranslate("partials/search-filters",{});return $('[component="search/filters"]').replaceWith(c),$("#search-in").val(ajaxify.data.searchDefaultIn),$("#post-sort-by").val(ajaxify.data.searchDefaultSortBy),$("#match-words-filter").val("all"),$("#show-results-as").val("posts"),k($('[component="user/filter"]'),[]),B($('[component="tag/filter"]'),[]),_([]),h.success("[[search:search-preferences-cleared]]"),!1})}function _(c){ajaxify.data.allCategoriesUrl="";const p=$('[component="category/filter"]');l.init(p,{selectedCids:c,updateButton:!1,onHidden:async function(s){const D=s.selectedCids.length>0&&s.selectedCids[0]!=="all";let j="[[search:categories]]";if(ajaxify.data.selectedCids=s.selectedCids,e=s.selectedCids,s.selectedCids.length===1&&s.selectedCids[0]==="watched")ajaxify.data.selectedCategory={cid:"watched"},j="[[search:categories-watched-categories]]";else if(s.selectedCids.length===1&&s.selectedCids[0]==="all")ajaxify.data.selectedCategory=null;else if(s.selectedCids.length>0){const A=await g.get(`/categories/${s.selectedCids[0]}`);ajaxify.data.selectedCategory=A,j=`[[search:categories-x, ${A.name}]]`}s.selectedCids.length>1&&(j=`[[search:categories-x, ${s.selectedCids.length}]]`),$('[component="category/filter/button"]').toggleClass("active-filter",D).find(".filter-label").translateText(j)},localCategories:[{cid:"watched",name:"[[category:watched-categories]]",icon:""}]})}function k(c,p){o.init(c,{selectedUsers:p,template:"partials/search-filters",onSelect:function(s){d=s},onHidden:function(s){const D=s.length>0;let j="[[search:posted-by]]";D&&(j=r.compile("search:posted-by-usernames",d.map(A=>A.username).join(", "))),c.find('[component="user/filter/button"]').toggleClass("active-filter",D).find(".filter-label").translateText(j)}})}function B(c,p){i=p;async function s(){const A=await app.parseAndTranslate("partials/search-filters","tagFilterSelected",{tagFilterSelected:i});c.find('[component="tag/filter/selected"]').html(A)}function D(A){const I=utils.escapeHTML(A);return{value:A,valueEscaped:I,valueEncoded:encodeURIComponent(I),class:I.replace(/\s/g,"-")}}async function j(){let A={tags:[]};const I=c.find('[component="tag/filter/search"]').val();if(I&&I.length>1&&(app.user.privileges["search:tags"]?A=await socket.emit("topics.searchAndLoadTags",{query:I}):A={tags:[D(I)]}),!A.tags.length){c.find('[component="tag/filter/results"]').translateHtml("[[tags:no-tags-found]]");return}A.tags=A.tags.slice(0,20);const P={};A.tags.forEach(L=>{P[L.valueEscaped]=L});const M=await app.parseAndTranslate("partials/search-filters","tagFilterResults",{tagFilterResults:A.tags});c.find('[component="tag/filter/results"]').html(M),c.find('[component="tag/filter/results"] [data-tag]').on("click",async function(){i.push(P[$(this).attr("data-tag")]),s()})}c.find('[component="tag/filter/search"]').on("keyup",utils.debounce(function(){app.user.privileges["search:tags"]&&j()},1e3)),c.on("click",'[component="tag/filter/delete"]',function(){const A=$(this).attr("data-tag");i=i.filter(I=>I.valueEscaped!==A),s()}),c.find('[component="tag/filter/search"]').on("keyup",A=>{if(A.key==="Enter"&&!app.user.privileges["search:tags"]){const I=c.find('[component="tag/filter/search"]').val();I&&i.every(P=>P.value!==I)&&(i.push(D(I)),s()),c.find('[component="tag/filter/search"]').val("")}}),c.on("shown.bs.dropdown",function(){c.find('[component="tag/filter/search"]').trigger("focus")})}return n}.apply(S,C),m!==void 0&&(F.exports=m)},74344:(F,S,u)=>{u.r(S),u.d(S,{del:()=>i,get:()=>r,head:()=>l,patch:()=>n,post:()=>o,put:()=>d});var C=u(85233),m=u.n(C),y=u(63281),v=u.n(y);const f=config.relative_path+"/api/v3";async function h(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:f+e.url,typeof t=="function"){g(e).then(a=>t(null,a),a=>t(a));return}try{return await g(e)}catch(a){if(a.message==="A valid login session was not found. Please log in and try again.")return(0,y.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go("login")});throw a}}async function g(e){const{url:t}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,C.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const a=await fetch(t,e),{headers:E}=a,x=E.get("content-type"),b=x&&x.startsWith("application/json");let w;if(e.method!=="head"&&(b?w=await a.json():w=await a.text()),!a.ok)throw w?new Error(b?w.status.message:w):new Error(a.statusText);return b&&w&&w.hasOwnProperty("status")&&w.hasOwnProperty("response")?w.response:w}function r(e,t,a){return h({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},a)}function l(e,t,a){return h({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},a)}function o(e,t,a){return h({url:e,method:"post",data:t,headers:{"x-csrf-token":config.csrf_token}},a)}function n(e,t,a){return h({url:e,method:"patch",data:t,headers:{"x-csrf-token":config.csrf_token}},a)}function d(e,t,a){return h({url:e,method:"put",data:t,headers:{"x-csrf-token":config.csrf_token}},a)}function i(e,t,a){return h({url:e,method:"delete",data:t,headers:{"x-csrf-token":config.csrf_token}},a)}},39941:(F,S,u)=>{var C,m;C=[u(22905),u(74344),u(85233)],m=function(y,v,f){const h={};h.init=function(r,l){if(!r||!r.length)return;l=l||{},l.states=l.states||["watching","notwatching","ignoring"],l.template=l.template||"partials/category/filter-dropdown-left",f.fire("action:category.filter.options",{el:r,options:l}),y.init(r,l);let o=[],n=[];Array.isArray(l.selectedCids)?o=l.selectedCids.map(String):Array.isArray(ajaxify.data.selectedCids)&&(o=ajaxify.data.selectedCids.map(String)),n=o.slice(),r.on("hidden.bs.dropdown",function(){let d=n.length!==o.length;if(n.forEach(function(i,e){i!==o[e]&&(d=!0)}),n=o.slice(),d&&(l.updateButton?l.updateButton({el:r,changed:d,selectedCids:o.slice()}):l.updateButton!==!1&&g(r,o)),l.onHidden){l.onHidden({changed:d,selectedCids:o.slice()});return}if(d){let i=window.location.pathname;const e=utils.params();o.length?e.cid=o:delete e.cid,delete e.page,Object.keys(e).length&&(i+="?"+decodeURIComponent($.param(e))),ajaxify.go(i)}}),r.on("click",'[component="category/list"] [data-cid]',function(){const d=r.find('[component="category/list"]'),i=$(this),e=i.find("a").attr("href");if(e&&e!=="#"&&e.length)return;const t=i.attr("data-cid"),a=i.find('[component="category/select/icon"]');return t!=="all"?(o.includes(t)?o.splice(o.indexOf(t),1):o.push(t),o.sort(function(E,x){return E-x}),a.toggleClass("invisible"),d.find('[data-cid="all"] i').toggleClass("invisible",!!o.length)):(r.find('[component="category/select/icon"]').addClass("invisible"),d.find('[data-cid="all"] i').removeClass("invisible"),o=[]),l.selectedCids=o,l.onSelect&&l.onSelect({cid:t,selectedCids:o.slice()}),!1})};function g(r,l){l.length>1?o({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):l.length===1?v.get(`/categories/${l[0]}`,{}).then(o):o();function o(n){app.parseAndTranslate("partials/category/filter-dropdown-content",{selectedCategory:n},function(d){r.find("button").replaceWith($("<div/>").html(d).find("button"))})}}return h}.apply(S,C),m!==void 0&&(F.exports=m)},22905:(F,S,u)=>{var C,m;C=[u(7927),u(73138)],m=function(y,v){const f={};return f.init=function(h,g){let r=null;g=g||{},g.privilege=g.privilege||"topics:read",g.states=g.states||["watching","notwatching","ignoring"],g.cacheList=g.hasOwnProperty("cacheList")?g.cacheList:!0;let l=[];Array.isArray(g.localCategories)&&(l=g.localCategories.map(e=>({...e}))),g.selectedCids=g.selectedCids||ajaxify.data.selectedCids||[];const o=h.find('[component="category-selector-search"]');if(!o.length)return;const n=o.parent('[component="category/dropdown"]').length>0||o.parent('[component="category-selector"]').length>0;h.on("show.bs.dropdown",function(){n&&(h.find(".dropdown-toggle").css({visibility:"hidden"}),o.removeClass("hidden"),o.css({"z-index":h.find(".dropdown-toggle").css("z-index")+1}));function e(){const t=o.find("input").val();t.length>1||!t&&!r?d(t,function(a){r=g.cacheList&&(r||a),i(a)}):!t&&r&&i(r)}o.on("click",function(t){t.preventDefault(),t.stopPropagation()}),o.find("input").val("").on("keyup",utils.debounce(e,300)),e()}),h.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||o.find("input").focus()}),h.on("hide.bs.dropdown",function(){n&&(h.find(".dropdown-toggle").css({visibility:"inherit"}),o.addClass("hidden")),o.off("click"),o.find("input").off("keyup")});function d(e,t){socket.emit("categories.categorySearch",{search:e,query:utils.params(),parentCid:g.parentCid||0,selectedCids:g.selectedCids,privilege:g.privilege,states:g.states,showLinks:g.showLinks},function(a,E){if(a)return y.error(a);t(l.concat(E))})}function i(e){const t=g.selectedCids.map(String);e.forEach(function(a){a.selected=t.includes(String(a.cid))}),app.parseAndTranslate(g.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(a){h.find('[component="category/list"]').html(a.find('[component="category/list"]').html()),h.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length);const E=v.Dropdown.getInstance(h.find(".dropdown-toggle").get(0));E&&E.update()})}},f}.apply(S,C),m!==void 0&&(F.exports=m)},7073:(F,S,u)=>{var C,m;C=[u(32230),u(66603),u(85233),u(7927),u(73138)],m=function(y,v,f,h,g){const r={current:{}};r.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,e)=>{l($(e),n)})};function l(n,d){const i=n.find('[component="search/button"]'),e=n.find('[component="search/fields"]'),t=e.find('input[name="query"]'),a=e.find("#quick-search-container"),E=e.hasClass("hidden");n.find(".advanced-search-link").off("mousedown").on("mousedown",function(){ajaxify.go("/search")}),E&&t.off("blur").on("blur",function(){setTimeout(function(){t.is(":focus")||(e.addClass("hidden"),i.removeClass("hidden"))},200)}),t.off("focus");const x={inputEl:t,resultEl:a};r.enableQuickSearch({searchOptions:d,searchElements:x}),i.off("click").on("click",function(b){return!config.loggedIn&&!app.user.privileges["search:content"]?(h.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(b.stopPropagation(),r.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const b=$(this).find('input[name="query"]'),w=r.getSearchPreferences();return w.term=b.val(),w.in=d.in,f.fire("action:search.submit",{searchOptions:w,searchElements:x}),r.query(w,function(){b.val(""),t.trigger("blur")}),!1})}r.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const d=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,e=n.searchElements.inputEl;let t=e.val();const a=i.find(".filter-category");function E(){ajaxify.data.template.category&&ajaxify.data.cid&&y.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(T){const O=$("<div></div>").html(T).text();a.find(".name").text(O)}),a.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function x(){n.searchOptions=Object.assign({},d),n.searchOptions.term=e.val(),E(),ajaxify.data.template.category&&ajaxify.data.cid&&a.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),f.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,r.api(n.searchOptions,function(T){if(i.find(".loading-indicator").addClass("hidden"),!T.posts||n.hideOnNoMatches&&!T.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");T.posts.forEach(function(O){const R=$("<div>"+O.content+"</div>").text(),_=e.val().toLowerCase().replace(/^in:topic-\d+/,""),k=Math.max(0,R.toLowerCase().indexOf(_)-40);O.snippet=utils.escapeHTML((k>0?"...":"")+R.slice(k,k+80)+(R.length-k>80?"...":""))}),app.parseAndTranslate("partials/quick-search-results",T,function(O){O.length&&O.find(".timeago").timeago(),i.toggleClass("hidden",!O.length||!e.is(":focus")).find(".quick-search-results-container").html(O.length?O:"");const R=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");r.highlightMatches(n.searchOptions.term,R),f.fire("action:search.quick.complete",{data:T,options:n})})})}i.find('.filter-category input[type="checkbox"]').on("change",function(){e.focus(),x()}),e.off("keyup").on("keyup",utils.debounce(function(){if(e.val().length<3){i.addClass("hidden"),t=e.val();return}if(e.val()!==t){if(t=e.val(),!e.is(":focus"))return i.addClass("hidden");x()}},500));let b=!1;i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")}),b=!0}),e.on("blur",function(){setTimeout(function(){!e.is(":focus")&&!b&&!i.hasClass("hidden")&&i.addClass("hidden")},200)});let w=!1;f.on("action:ajaxify.end",function(){ajaxify.isCold()||(w=!0)}),e.on("focus",function(){b=!1;const T=e.val();t=T,T&&i.find("#quick-search-results").children().length&&(E(),w?(x(),w=!1):i.removeClass("hidden"),e[0].setSelectionRange(T.startsWith("in:topic")?T.indexOf(" ")+1:0,T.length))}),e.off("refresh").on("refresh",function(){x()})},r.showAndFocusInput=function(n){const d=n.parents(".dropdown-menu");if(d.length){const i=d.siblings("[data-bs-toggle]"),e=g.Dropdown.getOrCreateInstance(i[0]);e&&e.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},r.query=function(n,d){d=d||function(){},ajaxify.go("search?"+o(n),d)},r.api=function(n,d){const i=config.relative_path+"/api/search?"+o(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const e=config.relative_path+"/search?"+o(n);$.get(i,function(t){t.url=e,d(t)})};function o(n){const d=n.in||"titles";let i=n.term.replace(/^[ ?#]*/,"");try{i=encodeURIComponent(i)}catch{return h.error("[[error:invalid-search-term]]")}const e={...n,term:i,in:d};return f.fire("action:search.createQueryString",{query:e,data:n}),decodeURIComponent($.param(e))}return r.getSearchPreferences=function(){try{return JSON.parse(v.getItem("search-preferences")||"{}")}catch{return{}}},r.highlightMatches=function(n,d){if(!n||!d.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(t=>t.length>1).map(function(t){return utils.escapeRegexChars(t)}).join("|"),e=new RegExp("("+i+")","gi");d.each(function(){const t=$(this),a=[];t.find("*").each(function(){$(this).after("<!-- "+a.length+" -->"),a.push($("<div></div>").append($(this)))}),t.html(t.html().replace(e,function(E,x){return'<strong class="search-match fw-bold text-decoration-underline">'+x+"</strong>"})),a.forEach(function(E,x){t.html(t.html().replace("<!-- "+x+" -->",function(){return E.html()}))})}),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-fluid")},r}.apply(S,C),m!==void 0&&(F.exports=m)},22568:(F,S,u)=>{var C,m,y;(function(v){m=[u(20648)],C=v,y=typeof C=="function"?C.apply(S,m):C,y!==void 0&&(F.exports=y)})(function(v){const f=v("[^\\p{L}\\s\\d\\-_]","g"),h=/[^\w\s\d\-_]/g,g=/^\s+|\s+$/g,r=/\s+/g,l=/-+/g,o=/-$/g,n=/^-/g,d=/^[\w\d\s.,\-@]+$/;return function(e,t){return e?(e=String(e).replace(g,""),d.test(e)?e=e.replace(h,"-"):e=v.replace(e,f,"-"),e=t?e:e.toLocaleLowerCase(),e=e.replace(r,"-"),e=e.replace(l,"-"),e=e.replace(o,""),e=e.replace(n,""),e):""}})},66603:(F,S,u)=>{var C;C=function(){function m(){this._store={},this._keys=[]}m.prototype.isMock=!0,m.prototype.setItem=function(f,h){f=String(f),this._keys.indexOf(f)===-1&&this._keys.push(f),this._store[f]=h},m.prototype.getItem=function(f){return f=String(f),this._keys.indexOf(f)===-1?null:this._store[f]},m.prototype.removeItem=function(f){f=String(f),this._keys=this._keys.filter(function(h){return h!==f}),this._store[f]=null},m.prototype.clear=function(){this._keys=[],this._store={}},m.prototype.key=function(f){return f=parseInt(f,10)||0,this._keys[f]},Object.defineProperty&&Object.defineProperty(m.prototype,"length",{get:function(){return this._keys.length}});let y;const v=Date.now().toString();try{if(y=window.localStorage,y.setItem(v,v),y.getItem(v)!==v)throw Error("localStorage behaved unexpectedly");return y.removeItem(v),y}catch(f){console.warn(f),console.warn("localStorage failed, falling back on sessionStorage");try{if(y=window.sessionStorage,y.setItem(v,v),y.getItem(v)!==v)throw Error("sessionStorage behaved unexpectedly");return y.removeItem(v),y}catch(h){return console.warn(h),console.warn("sessionStorage failed, falling back on memory storage"),new m}}}.call(S,u,S,F),C!==void 0&&(F.exports=C)},36012:(F,S,u)=>{var C,m;C=[u(74344),u(85233),u(22568),u(59006)],m=function(y,v,f,h){const g={};return g.init=function(r,l){if(!r||!r.length)return;l=l||{};let o,n=[];l.selectedUsers&&(n=l.selectedUsers.map(t=>({...t}))),v.fire("action:user.filter.options",{el:r,options:l});async function d(){const t=l.selectedBlock||"userFilterSelected",a={};if(t.indexOf(".")!==-1){const x=t.split(".");a[x[0]]={},a[x[0]][x[1]]=n}else a[t]=n;const E=await app.parseAndTranslate(l.template,t,a);r.find('[component="user/filter/selected"]').html(E)}async function i(){await d(),l.onSelect&&l.onSelect(n)}async function e(){let t={users:[]};const a=r.find('[component="user/filter/search"]').val();if(a&&a.length>1)if(app.user.privileges["search:users"])t=await y.get("/api/users",{query:a});else try{const b=await y.get(`/api/user/${f(a)}`);t.users.push(b)}catch{}if(!t.users.length){r.find('[component="user/filter/results"]').translateHtml("[[users:no-users-found]]");return}t.users=t.users.slice(0,20);const E={};t.users.forEach(b=>{E[b.uid]=b});const x=await app.parseAndTranslate(l.template,"userFilterResults",{userFilterResults:t.users});r.find('[component="user/filter/results"]').html(x),r.find('[component="user/filter/results"] [data-uid]').on("click",async function(){const b=parseInt($(this).attr("data-uid"),10);n.find(w=>w.uid===b)||(n.push(E[b]),await i())})}r.find('[component="user/filter/search"]').on("keyup",()=>{r.find('[component="user/filter/results"]').html(o)}),r.find('[component="user/filter/search"]').on("keyup",utils.debounce(function(){app.user.privileges["search:users"]&&e()},1e3)),r.on("click",'[component="user/filter/delete"]',async function(){const t=$(this).attr("data-uid");n=n.filter(a=>parseInt(a.uid,10)!==parseInt(t,10)),await i()}),r.find('[component="user/filter/search"]').on("keyup",t=>{t.key==="Enter"&&!app.user.privileges["search:users"]&&e()}),r.on("shown.bs.dropdown",function(){r.find('[component="user/filter/search"]').trigger("focus")}),r.on("hidden.bs.dropdown",function(){l.onHidden&&l.onHidden(n)}),h.render(l.placeholderTemplate||"partials/userFilter-placeholders").then(t=>{o=t})},g}.apply(S,C),m!==void 0&&(F.exports=m)}}]);
