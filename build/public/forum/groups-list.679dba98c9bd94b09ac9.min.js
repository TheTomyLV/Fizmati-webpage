"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[87171,70565,53375,83014,99617],{17592:(M,w,i)=>{var g,m;g=[i(25142),i(59006),i(74344),i(63281),i(7927)],m=function(E,x,p,c,f){const r={};return r.init=function(){E.init(r.loadMoreGroups),$('button[data-action="new"]').on("click",function(){c.prompt("[[groups:new-group.group-name]]",function(s){s&&s.length&&p.post("/groups",{name:s}).then(h=>{ajaxify.go("groups/"+h.slug)}).catch(f.error)})});const l=utils.params();$("#search-sort").val(l.sort||"alpha"),$("#search-text").on("keyup",r.search),$("#search-button").on("click",r.search),$("#search-sort").on("change",function(){ajaxify.go("groups?sort="+$("#search-sort").val())})},r.loadMoreGroups=function(l){l<0||E.loadMore("groups.loadMore",{sort:$("#search-sort").val(),after:$('[component="groups/container"]').attr("data-nextstart")},function(s,h){s&&s.groups.length?x.render("partials/groups/list",{groups:s.groups}).then(function(v){$("#groups-list").append(v),h()}):h(),s&&s.nextStart&&$('[component="groups/container"]').attr("data-nextstart",s.nextStart)})},r.search=function(){const l=$("#groups-list"),s=$("#search-text"),h=$("#search-sort");return socket.emit("groups.search",{query:s.val(),options:{sort:h.val(),filterHidden:!0,showMembers:!0,hideEphemeralGroups:!0}},function(v,n){if(v)return f.error(v);n=n.filter(function(t){return t.name!=="registered-users"&&t.name!=="guests"}),x.render("partials/groups/list",{groups:n}).then(function(t){l.empty().append(t)})}),!1},r}.apply(w,g),m!==void 0&&(M.exports=m)},25142:(M,w,i)=>{var g,m;g=[i(85233),i(7927)],m=function(E,x){const p={};let c,f=0,r=!1,l,s=0;p.init=function(n,t){const e=$("body");typeof n=="function"?(c=n,l=e):(c=t,l=n||e),f=$(window).scrollTop(),$(window).off("scroll",h).on("scroll",h),e.height()<=$(window).height()&&c(1)};function h(){s&&clearTimeout(s),s=setTimeout(function(){s=0,v()},60)}function v(){const n=utils.findBootstrapEnvironment(),t=(n==="xs"||n==="sm")&&$("html").hasClass("composing");if(r||t||app.flags._glance)return;const e=$(window).scrollTop(),o=$(window).height(),a=l.height()-o,y=l.offset()?l.offset().top:0,d=100*(e-y)/(a<=0?o:a),u=15,D=85,T=e>f?1:-1;(d<u&&e<f||d>D&&e>f||d<0&&T>0&&a<0)&&c(T),f=e}return p.loadMore=function(n,t,e){if(r)return;r=!0;const o={method:n,data:t};E.fire("action:infinitescroll.loadmore",o),socket.emit(o.method,o.data,function(a,y){if(a)return r=!1,x.error(a);e(y,function(){r=!1})})},p.loadMoreXhr=function(n,t){if(r)return;r=!0;const e=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),o={url:e,data:n};E.fire("action:infinitescroll.loadmore.xhr",o),$.get(e,n,function(a){t(a,function(){r=!1})}).fail(function(a){r=!1,x.error(String(a.responseJSON||"[[error:no-connection]]"))})},p.removeExtra=function(n,t,e){let o=$();if(n.length<=e)return o;const a=n.length-e;if(t>0){const y=$(document).height(),d=$(window).scrollTop();o=n.slice(0,a).remove(),$(window).scrollTop(d+($(document).height()-y))}else o=n.slice(n.length-a).remove();return o},p}.apply(w,g),m!==void 0&&(M.exports=m)},74344:(M,w,i)=>{i.r(w),i.d(w,{del:()=>n,get:()=>r,head:()=>l,patch:()=>h,post:()=>s,put:()=>v});var g=i(85233),m=i.n(g),E=i(63281),x=i.n(E);const p=config.relative_path+"/api/v3";async function c(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:p+t.url,typeof e=="function"){f(t).then(o=>e(null,o),o=>e(o));return}try{return await f(t)}catch(o){if(o.message==="A valid login session was not found. Please log in and try again.")return(0,E.confirm)("[[error:api.reauth-required]]",a=>{a&&ajaxify.go("login")});throw o}}async function f(t){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,g.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const o=await fetch(e,t),{headers:a}=o,y=a.get("content-type"),d=y&&y.startsWith("application/json");let u;if(t.method!=="head"&&(d?u=await o.json():u=await o.text()),!o.ok)throw u?new Error(d?u.status.message:u):new Error(o.statusText);return d&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function r(t,e,o){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},o)}function l(t,e,o){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"head"},o)}function s(t,e,o){return c({url:t,method:"post",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function h(t,e,o){return c({url:t,method:"patch",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function v(t,e,o){return c({url:t,method:"put",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function n(t,e,o){return c({url:t,method:"delete",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}}}]);
