(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[588,70565,83014,99617,62735,10882,43034,79191,3564],{74344:(w,E,u)=>{"use strict";u.r(E),u.d(E,{del:()=>s,get:()=>o,head:()=>a,patch:()=>e,post:()=>f,put:()=>i});var h=u(85233),b=u.n(h),p=u(63281),d=u.n(p);const n=config.relative_path+"/api/v3";async function r(t,l){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:n+t.url,typeof l=="function"){g(t).then(c=>l(null,c),c=>l(c));return}try{return await g(t)}catch(c){if(c.message==="A valid login session was not found. Please log in and try again.")return(0,p.confirm)("[[error:api.reauth-required]]",v=>{v&&ajaxify.go("login")});throw c}}async function g(t){const{url:l}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,h.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const c=await fetch(l,t),{headers:v}=c,k=v.get("content-type"),C=k&&k.startsWith("application/json");let m;if(t.method!=="head"&&(C?m=await c.json():m=await c.text()),!c.ok)throw m?new Error(C?m.status.message:m):new Error(c.statusText);return C&&m&&m.hasOwnProperty("status")&&m.hasOwnProperty("response")?m.response:m}function o(t,l,c){return r({url:t+(l&&Object.keys(l).length?"?"+$.param(l):"")},c)}function a(t,l,c){return r({url:t+(l&&Object.keys(l).length?"?"+$.param(l):""),method:"head"},c)}function f(t,l,c){return r({url:t,method:"post",data:l,headers:{"x-csrf-token":config.csrf_token}},c)}function e(t,l,c){return r({url:t,method:"patch",data:l,headers:{"x-csrf-token":config.csrf_token}},c)}function i(t,l,c){return r({url:t,method:"put",data:l,headers:{"x-csrf-token":config.csrf_token}},c)}function s(t,l,c){return r({url:t,method:"delete",data:l,headers:{"x-csrf-token":config.csrf_token}},c)}},45482:(w,E,u)=>{w.exports=u(35729)},83713:(w,E,u)=>{w.exports=u(51077)},38259:(w,E,u)=>{w.exports=u(65616)},27145:(w,E,u)=>{"use strict";w=u.nmd(w);var h,b;h=[u(32230),u(85233)],b=function(p,d){const n={};let r=!1;n.init=function(){if(n.taskbar=$('[component="taskbar"]'),n.tasklist=n.taskbar.find("ul"),!n.taskbar.length||!n.tasklist.length){r=!0;return}n.taskbar.on("click","li",async function(){const e=$(this),i=e.attr("data-module"),s=e.attr("data-uuid"),t=await app.require(i);return e.hasClass("active")?t.minimize(s):(o(),t.load(s),n.toggleNew(s,!1),n.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){n.closeAll()})},n.close=async function(e,i){if(r)return;if(n.tasklist.find('[data-module="'+w+'"][data-uuid="'+i+'"]').length){const t=await app.require(e);t&&typeof t.close=="function"&&t.close(i)}},n.closeAll=function(e){if(r)return;let i="[data-uuid]";e&&(i='[data-module="'+e+'"]'+i),n.tasklist.find(i).each(function(s,t){n.close(e||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},n.discard=function(e,i){if(r)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+i+'"]').remove(),g()},n.push=function(e,i,s,t){if(t=t||function(){},r)return t();const l=n.tasklist.find('li[data-uuid="'+i+'"]'),c={module:e,uuid:i,options:s,element:l};d.fire("filter:taskbar.push",c),!l.length&&c.module?a(c,t):t(l)},n.get=function(e){return r?[]:$('[data-module="'+e+'"]').map(function(s,t){return $(t).data()})},n.minimize=function(e,i){if(r)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+i+'"]').toggleClass("active",!1)},n.toggleNew=function(e,i,s){if(r)return;n.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",i),s||d.fire("action:taskbar.toggleNew",e)},n.updateActive=function(e){if(r)return;const i=n.tasklist.find("li");i.removeClass("active"),i.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},n.isActive=function(e){return r?!1:n.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function g(){if(r)return;n.tasklist.find("li").length>0?n.taskbar.attr("data-active","1"):n.taskbar.removeAttr("data-active")}function o(){r||n.tasklist.find(".active").removeClass("active")}function a(e,i){if(r)return i();p.translate(e.options.title,function(s){const t=$("<div></div>").text(s||"NodeBB Task").html(),l=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&o(),n.tasklist.append(l),g(),e.element=l,l.data(e),d.fire("action:taskbar.pushed",e),i(l)})}const f=function(e,i,s){switch(i){case"title":e.find('[component="taskbar/title"]').text(s);break;case"icon":e.find("i").attr("class","fa fa-"+s);break;case"image":e.find("a").css("background-image",s?'url("'+s.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",s);break;case"color":e.find("a").css("color",s);break}};return n.update=function(e,i,s){if(r)return;const t=n.tasklist.find('[data-module="'+e+'"][data-uuid="'+i+'"]');if(!t.length)return;const l=t.data();Object.keys(s).forEach(function(c){l[c]=s[c],f(t,c,s[c])}),t.data(l)},n}.apply(E,h),b!==void 0&&(w.exports=b)},62023:(w,E,u)=>{"use strict";var h,b;h=[u(74344),u(63281),u(7927),u(50431),u(59006),u(32230),u(62526)],b=function(p,d,n,r,g,o){const a={};return a.get=f=>p.get(`/topics/${f}/thumbs`,{}),a.getByPid=f=>p.get(`/posts/${f}`,{}).then(e=>a.get(e.tid)),a.delete=(f,e)=>p.del(`/topics/${f}/thumbs`,{path:e}),a.deleteAll=f=>{a.get(f).then(e=>{Promise.all(e.map(i=>a.delete(f,i.url)))})},a.upload=f=>new Promise(e=>{r.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${f}/thumbs`},function(i){e(i)})}),a.modal={},a.modal.open=function(f){const{id:e,pid:i}=f;let{modal:s}=f,t;return new Promise(l=>{Promise.all([a.get(e),i?a.getByPid(i):[]]).then(c=>new Promise(v=>{const k=c.reduce((C,m)=>C.concat(m));t=k.length,v(k)})).then(c=>g.render("modals/topic-thumbs",{thumbs:c})).then(c=>{s?o.translate(c,function(v){s.find(".bootbox-body").html(v),a.modal.handleSort({modal:s,numThumbs:t})}):(s=d.dialog({title:"[[modules:thumbs.modal.title]]",message:c,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(a.upload(e).then(()=>{a.modal.open({...f,modal:s}),Promise.all([u.e(61006),u.e(18099),u.e(10830),u.e(8311)]).then(function(){var v=[u(44541)];(k=>{k.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),l()}).apply(null,v)}).catch(u.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),a.modal.handleDelete({...f,modal:s}),a.modal.handleSort({modal:s,numThumbs:t}))})})},a.modal.handleDelete=f=>{f.modal.get(0).addEventListener("click",i=>{i.target.closest('button[data-action="remove"]')&&d.confirm("[[modules:thumbs.modal.confirm-remove]]",s=>{if(!s)return;const t=i.target.closest("[data-id]").getAttribute("data-id"),l=i.target.closest("[data-path]").getAttribute("data-path");p.del(`/topics/${t}/thumbs`,{path:l}).then(()=>{a.modal.open(f)}).catch(n.error)})})},a.modal.handleSort=({modal:f,numThumbs:e})=>{if(e>1){const i=f.find(".topic-thumbs-modal");i.sortable({items:"[data-id]"}),i.on("sortupdate",a.modal.handleSortChange)}},a.modal.handleSortChange=(f,e)=>{const i=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(i).forEach((s,t)=>{const l=s.getAttribute("data-id");let c=s.getAttribute("data-path");c=c.replace(new RegExp(`^${config.upload_url}`),""),p.put(`/topics/${l}/thumbs/order`,{path:c,order:t}).catch(n.error)})},a}.apply(E,h),b!==void 0&&(w.exports=b)},50431:(w,E,u)=>{"use strict";var h,b;h=[u(86569)],b=function(){const p={};p.show=function(o,a){const f=o.hasOwnProperty("fileSize")&&o.fileSize!==void 0?parseInt(o.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:o.hasOwnProperty("showHelp")&&o.showHelp!==void 0?o.showHelp:!0,fileSize:f,title:o.title||"[[global:upload-file]]",description:o.description||"",button:o.button||"[[global:upload]]",accept:o.accept?o.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const i=e.find("#uploadForm");i.attr("action",o.route),i.find("#params").val(JSON.stringify(o.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),i.submit()}),i.submit(function(){return d(e,f,a),!1})})},p.hideAlerts=function(o){$(o).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function d(o,a,f){n(o,"status","[[uploads:uploading-file]]"),o.find("#upload-progress-bar").css("width","0%"),o.find("#upload-progress-box").show().removeClass("hide");const e=o.find("#fileInput");if(!e.val())return n(o,"error","[[uploads:select-file-to-upload]]");if(!g(e[0],a))return n(o,"error","[[error:file-too-big, "+a+"]]");p.ajaxSubmit(o,f)}function n(o,a,f){p.hideAlerts(o),a==="error"&&o.find("#fileUploadSubmitBtn").removeClass("disabled"),f=f.replace(/&amp;#44/g,"&#44"),o.find("#alert-"+a).translateText(f).removeClass("hide")}p.ajaxSubmit=function(o,a){o.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=r(e),n(o,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,i,s,t){o.find("#upload-progress-bar").css("width",t+"%")},success:function(e){let i=r(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(i=e.response.images),a(i[0].url),n(o,"success","[[uploads:upload-success]]"),setTimeout(function(){p.hideAlerts(o),o.modal("hide")},750)}})};function r(o){if(typeof o=="string")try{return JSON.parse(o)}catch{return{error:"[[error:parse-error]]"}}return o}function g(o,a){return window.FileReader&&a?o.files[0].size<=a*1e3:!0}return p}.apply(E,h),b!==void 0&&(w.exports=b)},35729:(w,E,u)=>{"use strict";var h,b;h=[u(83713),u(38259),u(62023),u(10577)],b=function(p,d,n,r){var g={},o={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){g.exitFullscreen();var e=this;Promise.all([u.e(61006),u.e(18099),u.e(10830),u.e(92497)]).then(function(){var i=[u(44541)];(function(s){const t=e.get(0).getAttribute("data-uuid"),l=s.posts[t];(l.action==="topics.post"||l.action==="posts.edit"&&l.isMain)&&n.modal.open({id:t,pid:l.pid}).then(()=>{e.trigger("thumb.uploaded"),s.updateThumbCount(t,e)})}).apply(null,i)}).catch(u.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function i(){r.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),d.reposition(e),$(window).off("resize",i))}r.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",i),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",r.exit))}),r.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},a=[];g.exitFullscreen=function(){r.isEnabled&&r.isFullscreen&&r.exit()},g.addComposerButtons=function(){const e=$(".formatting-bar"),i=e.find(".formatting-group #fileForm");a.forEach(t=>{let l="";Array.isArray(t.dropdownItems)&&t.dropdownItems.length?l=f(t):l=`
					<li data-format="${t.name}" title="${t.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${t.iconClass}"></i>
					</li>
				`,i.before(l)}),e.find(".formatting-group>li").tooltip({container:"#content",animation:!1,trigger:"manual"}).on("mouseenter",function(t){const l=$(t.target);l.hasClass("dropdown-menu")||!!l.parents(".dropdown-menu").length||$(this).tooltip("show")}).on("click mouseleave",function(){$(this).tooltip("hide")})};function f(e){const i=e.dropdownItems.map(function(s){let t="";return s.badge&&(t='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${s.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${s.iconClass} text-secondary"></i> ${s.text}
						${t}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1" title="${e.title}">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" >
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${i}
				</ul>
			</li>
		`}return g.addButton=function(e,i,s,t){t=t||e.replace("fa fa-",""),o[t]=i,a.push({name:t,iconClass:e,title:s})},g.addDropdown=function(e){a.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(i=>{i.name&&i.onClick&&(o[i.name]=i.onClick)})},g.getDispatchTable=function(){return o},g.addButtonDispatch=function(e,i){o[e]=i},g.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(i){var s=$(this).attr("data-format"),t=$(this).parents('[component="composer"]').find("textarea")[0];o.hasOwnProperty(s)&&(o[s].call(e,t,t.selectionStart,t.selectionEnd,i),p.render(e))})},g}.apply(E,h),b!==void 0&&(w.exports=b)},51077:(w,E,u)=>{"use strict";var h,b;h=[u(85233)],b=function(p){var d={};return d.render=function(n,r){if(r=r||function(){},!n.find(".preview-container").is(":visible"))return r();var g=n.find("textarea");socket.emit("plugins.composer.renderPreview",g.val(),function(o,a){o||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-fluid"),n.find(".preview").html(a),p.fire("action:composer.preview",{postContainer:n,preview:a}),r())})},d.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var r=n.find("textarea"),g=n.find(".preview");if(r.length&&g.length){var o=r[0].scrollHeight-r.height();if(o===0)return;var a=r.scrollTop()/o;g.scrollTop(Math.max(g[0].scrollHeight-g.height(),0)*a)}}},d.handleToggler=function(n){const r=n.get(0);d.env=utils.findBootstrapEnvironment();const g=["xs","sm"].includes(d.env),o=r.querySelector('.formatting-bar [data-action="preview"]'),a=o.querySelector(".show-text"),f=o.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),i=config["composer-default"].hidePreviewOnOpen==="on";let s=!g&&(e===null&&!i||e==="true");const t=r.querySelector(".preview-container"),l=r.querySelector(".write-container");if(!o)return;function c(v){g?(t.classList.toggle("hide",!1),l.classList.toggle("maximized",!1),t.classList.toggle("d-none",!v),t.classList.toggle("d-flex",v),t.classList.toggle("w-100",v),l.classList.toggle("d-flex",!v),l.classList.toggle("d-none",v),l.classList.toggle("w-100",!v)):(t.classList.toggle("hide",!v),l.classList.toggle("w-50",v),l.classList.toggle("w-100",!v),localStorage.setItem("composer:previewToggled",v)),a.classList.toggle("hide",v),f.classList.toggle("hide",!v),v&&d.render(n),d.matchScroll(n)}d.toggle=c,o.addEventListener("click",v=>{v.button===0&&(s=!s,c(s))}),c(s)},d}.apply(E,h),b!==void 0&&(w.exports=b)},65616:(w,E,u)=>{"use strict";var h,b;h=[u(27145)],b=function(p){var d={},n=0,r=.3,g=.05,o=768,a=$("body"),f=$(window),e=$('[component="navbar"]');const i=document.getElementById("content");var s=e[0];function t(){return localStorage.getItem("composer:resizeRatio")||.5}function l(m){localStorage.setItem("composer:resizeRatio",Math.min(m,1))}function c(){var m;s?m=s.getBoundingClientRect():m={bottom:0};var x=Math.max(m.bottom,0),A={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return A.width=A.right,A.height=A.bottom,A.boundedTop=x,A.boundedHeight=A.bottom-x,A}function v(m,x){var A=c(),S=m[0],B=window.getComputedStyle(S),N=parseInt(B.getPropertyValue("min-height"),10),I=Math.max(N/window.innerHeight,r);if(A.width>=o){const T=(A.height-A.boundedHeight)/A.height;x=Math.min(Math.max(x,I+T),1);var D=x*A.boundedHeight/A.height;S.style.top=((1-D)*100).toString()+"%";var R=S.getBoundingClientRect();i.style.paddingBottom=(R.bottom-R.top).toString()+"px"}else S.style.top=0,i.style.paddingBottom=0;m.ratio=x,p.updateActive(m.attr("data-uuid"))}var k=v,C=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return C&&(k=function(m,x){C(function(){v(m,x),setTimeout(function(){f.trigger("action:composer.resize"),m.trigger("action:composer.resize")},0)})}),d.reposition=function(m){var x=t();x>=1-g&&(x=1,m.addClass("maximized")),k(m,x)},d.maximize=function(m,x){x?k(m,1):d.reposition(m)},d.handleResize=function(m){var x=0,A=0,S=0,B=m.find(".resizer"),N=B[0];function I(F){var z=N.getBoundingClientRect(),y=(z.top+z.bottom)/2;x=(y-F.clientY)/2,A=F.clientY,f.on("mousemove",D),f.on("mouseup",R),a.on("touchmove",T)}function D(F){var z=F.clientY-x,y=c(),P=(y.height-z)/y.boundedHeight;k(m,P)}function R(F){F.preventDefault(),S=F.clientY,m.find("textarea").focus(),f.off("mousemove",D),f.off("mouseup",R),a.off("touchmove",T);var z=S-x,y=c(),P=(y.height-z)/y.boundedHeight;S-A===0&&m.hasClass("maximized")?(m.removeClass("maximized"),P=!n||n>=1-g?.5:n,k(m,P)):S-A===0||P>=1-g?(k(m,1),m.addClass("maximized"),n=P):m.removeClass("maximized"),l(P)}function T(F){F.preventDefault(),D(F.touches[0])}B.on("mousedown",function(F){F.button===0&&(F.preventDefault(),I(F))}).on("touchstart",function(F){F.preventDefault(),I(F.touches[0])}).on("touchend",R)},d}.apply(E,h),b!==void 0&&(w.exports=b)},10577:w=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},u=w.exports,h=function(){for(var d,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,g=n.length,o={};r<g;r++)if(d=n[r],d&&d[1]in E){for(r=0;r<d.length;r++)o[n[0][r]]=d[r];return o}return!1}(),b={change:h.fullscreenchange,error:h.fullscreenerror},p={request:function(d,n){return new Promise(function(r,g){var o=function(){this.off("change",o),r()}.bind(this);this.on("change",o),d=d||E.documentElement;var a=d[h.requestFullscreen](n);a instanceof Promise&&a.then(o).catch(g)}.bind(this))},exit:function(){return new Promise(function(d,n){if(!this.isFullscreen){d();return}var r=function(){this.off("change",r),d()}.bind(this);this.on("change",r);var g=E[h.exitFullscreen]();g instanceof Promise&&g.then(r).catch(n)}.bind(this))},toggle:function(d,n){return this.isFullscreen?this.exit():this.request(d,n)},onchange:function(d){this.on("change",d)},onerror:function(d){this.on("error",d)},on:function(d,n){var r=b[d];r&&E.addEventListener(r,n,!1)},off:function(d,n){var r=b[d];r&&E.removeEventListener(r,n,!1)},raw:h};if(!h){u?w.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(p,{isFullscreen:{get:function(){return!!E[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return E[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!E[h.fullscreenEnabled]}}}),u?w.exports=p:window.screenfull=p})()}}]);
