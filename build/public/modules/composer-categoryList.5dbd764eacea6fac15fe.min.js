(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[34677,70565,83014,66623,49286,99617,43034],{74344:(h,y,d)=>{"use strict";d.r(y),d.d(y,{del:()=>a,get:()=>l,head:()=>u,patch:()=>t,post:()=>f,put:()=>n});var m=d(85233),g=d.n(m),p=d(63281),C=d.n(p);const o=config.relative_path+"/api/v3";async function s(e,i){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:o+e.url,typeof i=="function"){r(e).then(c=>i(null,c),c=>i(c));return}try{return await r(e)}catch(c){if(c.message==="A valid login session was not found. Please log in and try again.")return(0,p.confirm)("[[error:api.reauth-required]]",E=>{E&&ajaxify.go("login")});throw c}}async function r(e){const{url:i}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,m.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const c=await fetch(i,e),{headers:E}=c,k=E.get("content-type"),v=k&&k.startsWith("application/json");let b;if(e.method!=="head"&&(v?b=await c.json():b=await c.text()),!c.ok)throw b?new Error(v?b.status.message:b):new Error(c.statusText);return v&&b&&b.hasOwnProperty("status")&&b.hasOwnProperty("response")?b.response:b}function l(e,i,c){return s({url:e+(i&&Object.keys(i).length?"?"+$.param(i):"")},c)}function u(e,i,c){return s({url:e+(i&&Object.keys(i).length?"?"+$.param(i):""),method:"head"},c)}function f(e,i,c){return s({url:e,method:"post",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function t(e,i,c){return s({url:e,method:"patch",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function n(e,i,c){return s({url:e,method:"put",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}function a(e,i,c){return s({url:e,method:"delete",data:i,headers:{"x-csrf-token":config.csrf_token}},c)}},22905:(h,y,d)=>{"use strict";var m,g;m=[d(7927),d(73138)],g=function(p,C){const o={};return o.init=function(s,r){let l=null;r=r||{},r.privilege=r.privilege||"topics:read",r.states=r.states||["watching","notwatching","ignoring"],r.cacheList=r.hasOwnProperty("cacheList")?r.cacheList:!0;let u=[];Array.isArray(r.localCategories)&&(u=r.localCategories.map(e=>({...e}))),r.selectedCids=r.selectedCids||ajaxify.data.selectedCids||[];const f=s.find('[component="category-selector-search"]');if(!f.length)return;const t=f.parent('[component="category/dropdown"]').length>0||f.parent('[component="category-selector"]').length>0;s.on("show.bs.dropdown",function(){t&&(s.find(".dropdown-toggle").css({visibility:"hidden"}),f.removeClass("hidden"),f.css({"z-index":s.find(".dropdown-toggle").css("z-index")+1}));function e(){const i=f.find("input").val();i.length>1||!i&&!l?n(i,function(c){l=r.cacheList&&(l||c),a(c)}):!i&&l&&a(l)}f.on("click",function(i){i.preventDefault(),i.stopPropagation()}),f.find("input").val("").on("keyup",utils.debounce(e,300)),e()}),s.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||f.find("input").focus()}),s.on("hide.bs.dropdown",function(){t&&(s.find(".dropdown-toggle").css({visibility:"inherit"}),f.addClass("hidden")),f.off("click"),f.find("input").off("keyup")});function n(e,i){socket.emit("categories.categorySearch",{search:e,query:utils.params(),parentCid:r.parentCid||0,selectedCids:r.selectedCids,privilege:r.privilege,states:r.states,showLinks:r.showLinks},function(c,E){if(c)return p.error(c);i(u.concat(E))})}function a(e){const i=r.selectedCids.map(String);e.forEach(function(c){c.selected=i.includes(String(c.cid))}),app.parseAndTranslate(r.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(c){s.find('[component="category/list"]').html(c.find('[component="category/list"]').html()),s.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length);const E=C.Dropdown.getInstance(s.find(".dropdown-toggle").get(0));E&&E.update()})}},o}.apply(y,m),g!==void 0&&(h.exports=g)},50548:(h,y,d)=>{"use strict";var m,g;m=[d(22905),d(63281),d(85233),d(32230)],g=function(p,C,o,s){const r={};return r.init=function(l,u){if(!l||!l.length)return;u=u||{};const f=u.onSelect||function(){};u.states=u.states||["watching","notwatching","ignoring"],u.template=u.template||"partials/category/selector-dropdown-left",o.fire("action:category.selector.options",{el:l,options:u}),p.init(l,u);const t={el:l,selectedCategory:null};l.on("click","[data-cid]",function(){const a=$(this);return a.hasClass("disabled")?!1:(t.selectCategory(a.attr("data-cid")),f(t.selectedCategory))});let n=t.el.find('[component="category-selector-selected"]').html();return s.translate(n,a=>{n=a}),t.selectCategory=function(a){const e=t.el.find('[data-cid="'+a+'"]');t.selectedCategory={cid:a,name:e.attr("data-name")},e.length?t.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(n)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},u.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(u.template,{selectedCategory:u.selectedCategory},function(a){t.el.find('[component="category-selector-selected"]').html(a.find('[component="category-selector-selected"]').html())}),t},r.modal=function(l){l=l||{},l.onSelect=l.onSelect||function(){},l.onSubmit=l.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:l.message},function(u){const f=C.dialog({title:l.title||"[[modules:composer.select-category]]",message:u,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:n}}}),t=r.init(f.find('[component="category-selector"]'),l);function n(a){return a.preventDefault(),t.selectedCategory&&(l.onSubmit(t.selectedCategory),f.modal("hide")),!1}l.openOnLoad&&f.on("shown.bs.modal",function(){f.find(".dropdown-toggle").dropdown("toggle")}),f.find("form").on("submit",n)})},r}.apply(y,m),g!==void 0&&(h.exports=g)},98755:(h,y,d)=>{h.exports=d(77678)},27145:(h,y,d)=>{"use strict";h=d.nmd(h);var m,g;m=[d(32230),d(85233)],g=function(p,C){const o={};let s=!1;o.init=function(){if(o.taskbar=$('[component="taskbar"]'),o.tasklist=o.taskbar.find("ul"),!o.taskbar.length||!o.tasklist.length){s=!0;return}o.taskbar.on("click","li",async function(){const t=$(this),n=t.attr("data-module"),a=t.attr("data-uuid"),e=await app.require(n);return t.hasClass("active")?e.minimize(a):(l(),e.load(a),o.toggleNew(a,!1),o.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){o.closeAll()})},o.close=async function(t,n){if(s)return;if(o.tasklist.find('[data-module="'+h+'"][data-uuid="'+n+'"]').length){const e=await app.require(t);e&&typeof e.close=="function"&&e.close(n)}},o.closeAll=function(t){if(s)return;let n="[data-uuid]";t&&(n='[data-module="'+t+'"]'+n),o.tasklist.find(n).each(function(a,e){o.close(t||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})},o.discard=function(t,n){if(s)return;o.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').remove(),r()},o.push=function(t,n,a,e){if(e=e||function(){},s)return e();const i=o.tasklist.find('li[data-uuid="'+n+'"]'),c={module:t,uuid:n,options:a,element:i};C.fire("filter:taskbar.push",c),!i.length&&c.module?u(c,e):e(i)},o.get=function(t){return s?[]:$('[data-module="'+t+'"]').map(function(a,e){return $(e).data()})},o.minimize=function(t,n){if(s)return;o.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},o.toggleNew=function(t,n,a){if(s)return;o.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",n),a||C.fire("action:taskbar.toggleNew",t)},o.updateActive=function(t){if(s)return;const n=o.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},o.isActive=function(t){return s?!1:o.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function r(){if(s)return;o.tasklist.find("li").length>0?o.taskbar.attr("data-active","1"):o.taskbar.removeAttr("data-active")}function l(){s||o.tasklist.find(".active").removeClass("active")}function u(t,n){if(s)return n();p.translate(t.options.title,function(a){const e=$("<div></div>").text(a||"NodeBB Task").html(),i=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+e+'" component="taskbar/title">'+e+"</span></a>").attr({title:e,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&l(),o.tasklist.append(i),r(),t.element=i,i.data(t),C.fire("action:taskbar.pushed",t),n(i)})}const f=function(t,n,a){switch(n){case"title":t.find('[component="taskbar/title"]').text(a);break;case"icon":t.find("i").attr("class","fa fa-"+a);break;case"image":t.find("a").css("background-image",a?'url("'+a.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",a);break;case"color":t.find("a").css("color",a);break}};return o.update=function(t,n,a){if(s)return;const e=o.tasklist.find('[data-module="'+t+'"][data-uuid="'+n+'"]');if(!e.length)return;const i=e.data();Object.keys(a).forEach(function(c){i[c]=a[c],f(e,c,a[c])}),e.data(i)},o}.apply(y,m),g!==void 0&&(h.exports=g)},77678:(h,y,d)=>{"use strict";var m,g;m=[d(50548),d(27145),d(74344)],g=function(p,C,o){var s={},r;s.init=function(t,n){var a=t.find(".category-list-container");a.length&&(t.on("action:composer.resize",function(){l(t)}),s.updateTaskbar(t,n),r=p.init(a.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","notwatching","ignoring"],onSelect:function(e){n.hasOwnProperty("cid")&&f(t,n,e)}}),r&&(n.cid&&n.category?r.selectedCategory={cid:n.cid,name:n.category.name}:ajaxify.data.template.compose&&ajaxify.data.selectedCategory&&(r.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}),t.find(".category-name").translateText(r.selectedCategory?r.selectedCategory.name:"[[modules:composer.select-category]]").on("click",function(){p.modal({privilege:"topics:create",states:["watching","notwatching","ignoring"],openOnLoad:!0,showLinks:!1,onSubmit:function(e){t.find(".category-name").text(e.name),r.selectCategory(e.cid),n.hasOwnProperty("cid")&&f(t,n,e)}})}),l(t)))};function l(t){t.find('.category-list-container [component="category-selector"]').toggleClass("dropup",t.outerHeight()<$(window).height()/2)}s.getSelectedCid=function(){var t;return r&&(t=r.getSelectedCategory()),t?t.cid:0},s.updateTaskbar=function(t,n){parseInt(n.cid,10)&&o.get(`/categories/${n.cid}`,{}).then(function(a){u(t,a)})};function u(t,n){if(n){var a=t.attr("data-uuid");C.update("composer",a,{image:n.backgroundImage,color:n.color,"background-color":n.bgColor,icon:n.icon&&n.icon.slice(3)})}}async function f(t,n,a){n.cid=a.cid;const e=await window.fetch(`${config.relative_path}/api/category/${a.cid}`).then(i=>i.json());n.category=e,u(t,e),d.e(10656).then(function(){var i=[d(98166),d(88186),d(84964)];(function(c,E,k){c.onChangeCategory(e),E.onChangeCategory(t,n,a.cid,e),k.onChangeCategory(t,n),$(window).trigger("action:composer.changeCategory",{postContainer:t,postData:n,selectedCategory:a,categoryData:e})}).apply(null,i)}).catch(d.oe)}return s}.apply(y,m),g!==void 0&&(h.exports=g)}}]);
