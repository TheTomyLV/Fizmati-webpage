"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[52256,70565,83014,66623,99617],{74344:(E,p,l)=>{l.r(p),l.d(p,{del:()=>o,get:()=>s,head:()=>i,patch:()=>f,post:()=>t,put:()=>d});var h=l(85233),y=l.n(h),m=l(63281),w=l.n(m);const C=config.relative_path+"/api/v3";async function c(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:C+e.url,typeof n=="function"){r(e).then(a=>n(null,a),a=>n(a));return}try{return await r(e)}catch(a){if(a.message==="A valid login session was not found. Please log in and try again.")return(0,m.confirm)("[[error:api.reauth-required]]",u=>{u&&ajaxify.go("login")});throw a}}async function r(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const a=await fetch(n,e),{headers:u}=a,v=u.get("content-type"),A=v&&v.startsWith("application/json");let g;if(e.method!=="head"&&(A?g=await a.json():g=await a.text()),!a.ok)throw g?new Error(A?g.status.message:g):new Error(a.statusText);return A&&g&&g.hasOwnProperty("status")&&g.hasOwnProperty("response")?g.response:g}function s(e,n,a){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},a)}function i(e,n,a){return c({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},a)}function t(e,n,a){return c({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},a)}function f(e,n,a){return c({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},a)}function d(e,n,a){return c({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},a)}function o(e,n,a){return c({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},a)}},39941:(E,p,l)=>{var h,y;h=[l(22905),l(74344),l(85233)],y=function(m,w,C){const c={};c.init=function(s,i){if(!s||!s.length)return;i=i||{},i.states=i.states||["watching","notwatching","ignoring"],i.template=i.template||"partials/category/filter-dropdown-left",C.fire("action:category.filter.options",{el:s,options:i}),m.init(s,i);let t=[],f=[];Array.isArray(i.selectedCids)?t=i.selectedCids.map(String):Array.isArray(ajaxify.data.selectedCids)&&(t=ajaxify.data.selectedCids.map(String)),f=t.slice(),s.on("hidden.bs.dropdown",function(){let d=f.length!==t.length;if(f.forEach(function(o,e){o!==t[e]&&(d=!0)}),f=t.slice(),d&&(i.updateButton?i.updateButton({el:s,changed:d,selectedCids:t.slice()}):i.updateButton!==!1&&r(s,t)),i.onHidden){i.onHidden({changed:d,selectedCids:t.slice()});return}if(d){let o=window.location.pathname;const e=utils.params();t.length?e.cid=t:delete e.cid,delete e.page,Object.keys(e).length&&(o+="?"+decodeURIComponent($.param(e))),ajaxify.go(o)}}),s.on("click",'[component="category/list"] [data-cid]',function(){const d=s.find('[component="category/list"]'),o=$(this),e=o.find("a").attr("href");if(e&&e!=="#"&&e.length)return;const n=o.attr("data-cid"),a=o.find('[component="category/select/icon"]');return n!=="all"?(t.includes(n)?t.splice(t.indexOf(n),1):t.push(n),t.sort(function(u,v){return u-v}),a.toggleClass("invisible"),d.find('[data-cid="all"] i').toggleClass("invisible",!!t.length)):(s.find('[component="category/select/icon"]').addClass("invisible"),d.find('[data-cid="all"] i').removeClass("invisible"),t=[]),i.selectedCids=t,i.onSelect&&i.onSelect({cid:n,selectedCids:t.slice()}),!1})};function r(s,i){i.length>1?t({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):i.length===1?w.get(`/categories/${i[0]}`,{}).then(t):t();function t(f){app.parseAndTranslate("partials/category/filter-dropdown-content",{selectedCategory:f},function(d){s.find("button").replaceWith($("<div/>").html(d).find("button"))})}}return c}.apply(p,h),y!==void 0&&(E.exports=y)},22905:(E,p,l)=>{var h,y;h=[l(7927),l(73138)],y=function(m,w){const C={};return C.init=function(c,r){let s=null;r=r||{},r.privilege=r.privilege||"topics:read",r.states=r.states||["watching","notwatching","ignoring"],r.cacheList=r.hasOwnProperty("cacheList")?r.cacheList:!0;let i=[];Array.isArray(r.localCategories)&&(i=r.localCategories.map(e=>({...e}))),r.selectedCids=r.selectedCids||ajaxify.data.selectedCids||[];const t=c.find('[component="category-selector-search"]');if(!t.length)return;const f=t.parent('[component="category/dropdown"]').length>0||t.parent('[component="category-selector"]').length>0;c.on("show.bs.dropdown",function(){f&&(c.find(".dropdown-toggle").css({visibility:"hidden"}),t.removeClass("hidden"),t.css({"z-index":c.find(".dropdown-toggle").css("z-index")+1}));function e(){const n=t.find("input").val();n.length>1||!n&&!s?d(n,function(a){s=r.cacheList&&(s||a),o(a)}):!n&&s&&o(s)}t.on("click",function(n){n.preventDefault(),n.stopPropagation()}),t.find("input").val("").on("keyup",utils.debounce(e,300)),e()}),c.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||t.find("input").focus()}),c.on("hide.bs.dropdown",function(){f&&(c.find(".dropdown-toggle").css({visibility:"inherit"}),t.addClass("hidden")),t.off("click"),t.find("input").off("keyup")});function d(e,n){socket.emit("categories.categorySearch",{search:e,query:utils.params(),parentCid:r.parentCid||0,selectedCids:r.selectedCids,privilege:r.privilege,states:r.states,showLinks:r.showLinks},function(a,u){if(a)return m.error(a);n(i.concat(u))})}function o(e){const n=r.selectedCids.map(String);e.forEach(function(a){a.selected=n.includes(String(a.cid))}),app.parseAndTranslate(r.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(a){c.find('[component="category/list"]').html(a.find('[component="category/list"]').html()),c.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length);const u=w.Dropdown.getInstance(c.find(".dropdown-toggle").get(0));u&&u.update()})}},C}.apply(p,h),y!==void 0&&(E.exports=y)}}]);
