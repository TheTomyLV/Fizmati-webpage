"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[13130,70565,83014,66623,49286,99617,10999],{31433:(A,C,d)=>{var f,g;f=[d(50548),d(22568),d(74344),d(63281),d(7927)],g=function(m,p,y,i,r){const o={};o.init=function(){l(),c(),$(".groups-list").on("click","[data-action]",function(){const a=$(this),u=a.attr("data-action"),s=a.parents("tr[data-groupname]").attr("data-groupname");switch(u){case"delete":i.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(e){e&&y.del(`/groups/${p(s)}`,{}).then(ajaxify.refresh).catch(r.error)});break}})};function l(){$("#create").on("click",function(){app.parseAndTranslate("admin/partials/create_group_modal",{}).then(a=>{a.modal("show"),a.on("shown.bs.modal",function(){const u=$("#create-modal"),s=$("#create-group-name"),e=$("#create-modal-go"),n=$("#create-modal-error");s.trigger("focus"),u.on("keypress",function(t){t.key==="Enter"&&e.trigger("click")}),a.on("hidden.bs.modal",function(){a.modal("hide"),u.remove()}),e.on("click",function(){const t={name:s.val(),description:$("#create-group-desc").val(),private:$("#create-group-private").is(":checked")?1:0,hidden:$("#create-group-hidden").is(":checked")?1:0};y.post("/groups",t).then(h=>{n.addClass("hide"),s.val(""),u.on("hidden.bs.modal",function(){ajaxify.go("admin/manage/groups/"+h.name)}),u.modal("hide")}).catch(h=>{utils.hasLanguageKey(h.status.message)||(h.status.message="[[admin/manage/groups:alerts.create-failure]]"),n.translateHtml(h.status.message).removeClass("hide")})})})})})}function c(){const a=$("#group-search");function u(){if(!a.val())return ajaxify.refresh();$(".pagination").addClass("hide");const s=$(".groups-list");socket.emit("groups.search",{query:a.val(),options:{sort:"date"}},function(e,n){if(e)return r.error(e);app.parseAndTranslate("admin/manage/groups","groups",{groups:n,categories:ajaxify.data.categories},function(t){s.find("[data-groupname]").remove(),s.find("tbody").append(t)})})}a.on("keyup",utils.debounce(u,200))}return o}.apply(C,f),g!==void 0&&(A.exports=g)},74344:(A,C,d)=>{d.r(C),d.d(C,{del:()=>s,get:()=>o,head:()=>l,patch:()=>a,post:()=>c,put:()=>u});var f=d(85233),g=d.n(f),m=d(63281),p=d.n(m);const y=config.relative_path+"/api/v3";async function i(e,n){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:y+e.url,typeof n=="function"){r(e).then(t=>n(null,t),t=>n(t));return}try{return await r(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again.")return(0,m.confirm)("[[error:api.reauth-required]]",h=>{h&&ajaxify.go("login")});throw t}}async function r(e){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,f.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const t=await fetch(n,e),{headers:h}=t,_=h.get("content-type"),v=_&&_.startsWith("application/json");let E;if(e.method!=="head"&&(v?E=await t.json():E=await t.text()),!t.ok)throw E?new Error(v?E.status.message:E):new Error(t.statusText);return v&&E&&E.hasOwnProperty("status")&&E.hasOwnProperty("response")?E.response:E}function o(e,n,t){return i({url:e+(n&&Object.keys(n).length?"?"+$.param(n):"")},t)}function l(e,n,t){return i({url:e+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},t)}function c(e,n,t){return i({url:e,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function a(e,n,t){return i({url:e,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function u(e,n,t){return i({url:e,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}function s(e,n,t){return i({url:e,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},t)}},22905:(A,C,d)=>{var f,g;f=[d(7927),d(73138)],g=function(m,p){const y={};return y.init=function(i,r){let o=null;r=r||{},r.privilege=r.privilege||"topics:read",r.states=r.states||["watching","notwatching","ignoring"],r.cacheList=r.hasOwnProperty("cacheList")?r.cacheList:!0;let l=[];Array.isArray(r.localCategories)&&(l=r.localCategories.map(e=>({...e}))),r.selectedCids=r.selectedCids||ajaxify.data.selectedCids||[];const c=i.find('[component="category-selector-search"]');if(!c.length)return;const a=c.parent('[component="category/dropdown"]').length>0||c.parent('[component="category-selector"]').length>0;i.on("show.bs.dropdown",function(){a&&(i.find(".dropdown-toggle").css({visibility:"hidden"}),c.removeClass("hidden"),c.css({"z-index":i.find(".dropdown-toggle").css("z-index")+1}));function e(){const n=c.find("input").val();n.length>1||!n&&!o?u(n,function(t){o=r.cacheList&&(o||t),s(t)}):!n&&o&&s(o)}c.on("click",function(n){n.preventDefault(),n.stopPropagation()}),c.find("input").val("").on("keyup",utils.debounce(e,300)),e()}),i.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||c.find("input").focus()}),i.on("hide.bs.dropdown",function(){a&&(i.find(".dropdown-toggle").css({visibility:"inherit"}),c.addClass("hidden")),c.off("click"),c.find("input").off("keyup")});function u(e,n){socket.emit("categories.categorySearch",{search:e,query:utils.params(),parentCid:r.parentCid||0,selectedCids:r.selectedCids,privilege:r.privilege,states:r.states,showLinks:r.showLinks},function(t,h){if(t)return m.error(t);n(l.concat(h))})}function s(e){const n=r.selectedCids.map(String);e.forEach(function(t){t.selected=n.includes(String(t.cid))}),app.parseAndTranslate(r.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(t){i.find('[component="category/list"]').html(t.find('[component="category/list"]').html()),i.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length);const h=p.Dropdown.getInstance(i.find(".dropdown-toggle").get(0));h&&h.update()})}},y}.apply(C,f),g!==void 0&&(A.exports=g)},50548:(A,C,d)=>{var f,g;f=[d(22905),d(63281),d(85233),d(32230)],g=function(m,p,y,i){const r={};return r.init=function(o,l){if(!o||!o.length)return;l=l||{};const c=l.onSelect||function(){};l.states=l.states||["watching","notwatching","ignoring"],l.template=l.template||"partials/category/selector-dropdown-left",y.fire("action:category.selector.options",{el:o,options:l}),m.init(o,l);const a={el:o,selectedCategory:null};o.on("click","[data-cid]",function(){const s=$(this);return s.hasClass("disabled")?!1:(a.selectCategory(s.attr("data-cid")),c(a.selectedCategory))});let u=a.el.find('[component="category-selector-selected"]').html();return i.translate(u,s=>{u=s}),a.selectCategory=function(s){const e=a.el.find('[data-cid="'+s+'"]');a.selectedCategory={cid:s,name:e.attr("data-name")},e.length?a.el.find('[component="category-selector-selected"]').html(e.find('[component="category-markup"]').html()):a.el.find('[component="category-selector-selected"]').html(u)},a.getSelectedCategory=function(){return a.selectedCategory},a.getSelectedCid=function(){return a.selectedCategory?a.selectedCategory.cid:0},l.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(l.template,{selectedCategory:l.selectedCategory},function(s){a.el.find('[component="category-selector-selected"]').html(s.find('[component="category-selector-selected"]').html())}),a},r.modal=function(o){o=o||{},o.onSelect=o.onSelect||function(){},o.onSubmit=o.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:o.message},function(l){const c=p.dialog({title:o.title||"[[modules:composer.select-category]]",message:l,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:u}}}),a=r.init(c.find('[component="category-selector"]'),o);function u(s){return s.preventDefault(),a.selectedCategory&&(o.onSubmit(a.selectedCategory),c.modal("hide")),!1}o.openOnLoad&&c.on("shown.bs.modal",function(){c.find(".dropdown-toggle").dropdown("toggle")}),c.find("form").on("submit",u)})},r}.apply(C,f),g!==void 0&&(A.exports=g)},22568:(A,C,d)=>{var f,g,m;(function(p){g=[d(20648)],f=p,m=typeof f=="function"?f.apply(C,g):f,m!==void 0&&(A.exports=m)})(function(p){const y=p("[^\\p{L}\\s\\d\\-_]","g"),i=/[^\w\s\d\-_]/g,r=/^\s+|\s+$/g,o=/\s+/g,l=/-+/g,c=/-$/g,a=/^-/g,u=/^[\w\d\s.,\-@]+$/;return function(e,n){return e?(e=String(e).replace(r,""),u.test(e)?e=e.replace(i,"-"):e=p.replace(e,y,"-"),e=n?e:e.toLocaleLowerCase(),e=e.replace(o,"-"),e=e.replace(l,"-"),e=e.replace(c,""),e=e.replace(a,""),e):""}})}}]);
