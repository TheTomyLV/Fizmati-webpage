"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[12249],{48842:(w,p,b)=>{var o,c;o=[b(7927)],c=function(r){const l={};let d,f,u,m;l.init=function(){d=ajaxify.data.rewards,f=ajaxify.data.active,u=ajaxify.data.conditions,m=ajaxify.data.conditionals,$("[data-selected]").each(function(){k($(this))}),$("#active").on("change","[data-selected]",function(){_($(this))}).on("click",".delete",function(){const a=$(this).parents("[data-id]"),e=a.attr("data-id");return socket.emit("admin.rewards.delete",{id:e},function(t){t?r.error(t):r.success("[[admin/extend/rewards:alert.delete-success]]")}),a.remove(),!1}).on("click",".toggle",function(){const a=$(this);return a.parent().find(".toggle").removeClass("hidden"),a.addClass("hidden"),!1}),$("#new").on("click",y),$("#save").on("click",E),g()};function k(a){switch(a.val(a.attr("data-selected")),a.attr("name")){case"rid":h(a);break}}function _(a){switch(a.attr("data-selected",a.val()),a.attr("name")){case"rid":h(a);break}}function h(a){const e=a.parents("[data-rid]"),t=e.find(".inputs");let i,n="";for(const s in d)if(d.hasOwnProperty(s)&&d[s].rid===a.attr("data-selected")){i=d[s].inputs,e.attr("data-rid",d[s].rid);break}if(!i)return r.error("[[admin/extend/rewards:alert.no-inputs-found]] "+a.attr("data-selected"));i.forEach(function(s){switch(n+=`<label class="form-label text-nowrap" for="${s.name}">${s.label}<br />`,s.type){case"select":n+=`<select class="form-select form-select-sm" name="${s.name}" >`,s.values.forEach(function(v){n+=`<option value="${v.value}">${v.name}</option>`});break;case"text":n+=`<input type="text" class="form-control form-control-sm" name="${s.name}"  />`;break}n+="</label>"}),t.html(n)}function g(){$("[data-rid]").each(function(a){const e=$(this).find(".inputs"),t=f[a].rewards;for(const i in t)t.hasOwnProperty(i)&&e.find('[name="'+i+'"]').val(t[i])})}function y(){const a=$("#active"),e={active:[{disabled:!0,value:"",claimable:1,rid:null,id:null}],conditions:u,conditionals:m,rewards:d};app.parseAndTranslate("admin/extend/rewards","active",e,function(t){a.append(t),t.find("select").val("")})}function E(){const a=[];$("#active li").each(function(){const e={rewards:{}},t=$(this).find("form.main").serializeArray(),i=$(this).find("form.rewards").serializeArray();t.forEach(function(n){e[n.name]=n.value}),i.forEach(function(n){e.rewards[n.name]=n.value}),e.id=$(this).attr("data-id"),e.disabled=$(this).find(".toggle.disable").hasClass("hidden"),a.push(e)}),socket.emit("admin.rewards.save",a,function(e,t){if(e)return r.error(e);const i=document.getElementById("save");i.classList.toggle("saved",!0),setTimeout(()=>{i.classList.toggle("saved",!1)},5e3),$("#active li").each(function(n){$(this).attr("data-id")||$(this).attr("data-id",t[n].id)})})}return l}.apply(p,o),c!==void 0&&(w.exports=c)}}]);
