(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[32373],{53858:(s,d,o)=>{s.exports=o(71297)},71297:(s,d,o)=>{"use strict";var u,a;u=[o(7927),o(99764)],a=function(t,l){var g={},i=0;$(window).on("action:ajaxify.end",function(n,e){e.url==="admin/plugins/dbsearch"&&ajaxify.data.working?r():c()}),g.init=function(){$("#save").on("click",function(){return $.post(config.relative_path+"/api/admin/plugins/dbsearch/save",{_csrf:config.csrf_token,topicLimit:$("#topicLimit").val(),postLimit:$("#postLimit").val(),excludeCategories:$("#exclude-categories").val()},function(n){typeof n=="string"&&l.toggleSaveSuccess($("#save"))}),!1}),$("#reindex").on("click",function(){return bootbox.confirm("Are you sure you want to reindex all content? This might take a while depending on the amount of content. During the operation the forum might slow down.",function(n){n&&socket.emit("admin.plugins.dbsearch.reindex",function(e){if(e)return t.error(e),c();t.success("Started indexing content! This might take a while. You can check the progress on this page."),r()})}),!1}),$("#clear-index").on("click",function(){return bootbox.confirm("Are you sure you want to clear all indices? This might take a while depending on the amount of content. During the operation the forum might slow down.",function(n){n&&socket.emit("admin.plugins.dbsearch.clearIndex",function(e){if(e)return t.error(e),c();t.success("Started clearing index! This might take a while. You can check the progress on this page."),r()})}),!1}),$("#changeLanguage").on("click",function(){var n=$("#indexLanguage").val();t.success('Changing index language to "'+n+'".'),socket.emit("admin.plugins.dbsearch.changeLanguage",n,function(e){if(e)return t.error(e);t.success("Search index language changed!")})})};function r(){c(),i=setInterval(f,1e3)}function c(){i&&(clearInterval(i),i=0)}function f(){socket.emit("admin.plugins.dbsearch.checkProgress",function(n,e){if(n)return c(),t.error(n);var h=parseInt(e.working,10);h?$("#reindex").attr("disabled",!0):(clearInterval(i),$("#reindex").removeAttr("disabled")),$("#work-in-progress").toggleClass("hidden",!h),e.topicsPercent>=100&&e.postsPercent>=100&&(e.topicsPercent=100,e.postsPercent=100),$("#topics-indexed").text(e.topicsIndexed),$("#posts-indexed").text(e.postsIndexed),$("#messages-indexed").text(e.messagesIndexed),$(".topic-progress").css("width",e.topicsPercent+"%").text(e.topicsPercent+"%"),$(".post-progress").css("width",e.postsPercent+"%").text(e.postsPercent+"%"),$(".message-progress").css("width",e.messagesPercent+"%").text(e.messagesPercent+"%")})}return g}.apply(d,u),a!==void 0&&(s.exports=a)}}]);
